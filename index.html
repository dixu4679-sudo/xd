<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥åº·é¥®é£ŸåŠ©æ‰‹ - Food Shai Gama</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ==================== å…¨å±€æ ·å¼ ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        /* ==================== å¤´éƒ¨æ ·å¼ ==================== */
        .header {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            color: white;
            padding: 25px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo h1 {
            font-size: 2.2rem;
            margin-bottom: 5px;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-style: italic;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        #user-id-display {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .btn-small {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-small:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* ==================== ä¸»å†…å®¹åŒº ==================== */
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            min-height: 700px;
        }

        /* å·¦ä¾§åŠŸèƒ½åŒº */
        .features-section {
            background: #f8f9fa;
            padding: 30px;
            border-right: 1px solid #eaeaea;
        }

        .features-section h2 {
            color: #2E7D32;
            margin-bottom: 25px;
            font-size: 1.5rem;
        }

        .features-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .feature-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            text-align: center;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-color: #4CAF50;
        }

        .feature-card.active {
            border-color: #4CAF50;
            background: #f1f8e9;
        }

        .feature-icon {
            font-size: 2.5rem;
            color: #4CAF50;
            margin-bottom: 10px;
        }

        .feature-card h3 {
            color: #2E7D32;
            margin-bottom: 5px;
        }

        .feature-card p {
            color: #666;
            font-size: 0.9rem;
        }

        /* å³ä¾§å†…å®¹åŒº */
        .content-section {
            padding: 30px;
        }

        .content-panel {
            display: none;
        }

        .content-panel.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* ==================== é£Ÿç‰©æŸ¥è¯¢æ ·å¼ ==================== */
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
        }

        .search-box input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: #4CAF50;
        }

        #search-btn {
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 25px;
            padding: 0 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s;
        }

        #search-btn:hover {
            background: #45a049;
        }

        .category-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 25px;
        }

        .category-btn {
            padding: 8px 16px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-btn.active, .category-btn:hover {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        .food-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .food-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .food-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            border-color: #4CAF50;
        }

        .food-color {
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
        }

        .food-info {
            padding: 15px;
        }

        .food-info h3 {
            color: #2E7D32;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }

        .food-korean {
            color: #666;
            font-style: italic;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .food-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: #888;
        }

        .food-meta span {
            background: #f5f5f5;
            padding: 3px 8px;
            border-radius: 10px;
        }

        .click-count {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #4CAF50;
            font-weight: bold;
        }

        .no-results {
            grid-column: 1 / -1;
            text-align: center;
            padding: 50px;
            color: #888;
        }

        .no-results i {
            font-size: 3rem;
            color: #ccc;
            margin-bottom: 15px;
        }

        /* ==================== æ•°æ®ç»Ÿè®¡æ ·å¼ ==================== */
        .stats-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f1f8e9 0%, #e8f5e9 100%);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid #c8e6c9;
        }

        .stat-card h3 {
            color: #2E7D32;
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #1b5e20;
        }

        .stats-details {
            background: white;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e0e0e0;
        }

        .food-stats-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .food-stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            transition: background 0.3s;
        }

        .food-stat-item:hover {
            background: #f9f9f9;
        }

        .food-stat-name {
            flex: 0 0 150px;
        }

        .stat-bar {
            flex: 1;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            margin: 0 15px;
            overflow: hidden;
        }

        .stat-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #81c784);
            border-radius: 10px;
            transition: width 0.5s;
        }

        .food-stat-count {
            flex: 0 0 60px;
            text-align: right;
            font-weight: bold;
            color: #2E7D32;
        }

        .no-stats {
            text-align: center;
            padding: 40px;
            color: #888;
        }

        .no-stats i {
            font-size: 2rem;
            color: #ccc;
            margin-bottom: 10px;
        }

        /* ==================== æ’è¡Œæ¦œæ ·å¼ ==================== */
        .ranking-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e0e0e0;
        }

        .ranking-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 2px solid #eee;
            padding-bottom: 15px;
        }

        .ranking-tab {
            padding: 10px 20px;
            border: none;
            background: #f5f5f5;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .ranking-tab.active, .ranking-tab:hover {
            background: #4CAF50;
            color: white;
        }

        .ranking-list {
            margin-bottom: 30px;
        }

        .ranking-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
            transition: background 0.3s;
        }

        .ranking-item:hover {
            background: #f9f9f9;
        }

        .rank-number {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: #e8f5e9;
            color: #2E7D32;
            font-weight: bold;
            margin-right: 15px;
        }

        .rank-number.gold { background: #fff9c4; color: #f57c00; }
        .rank-number.silver { background: #f5f5f5; color: #757575; }
        .rank-number.bronze { background: #ffecb3; color: #e65100; }

        .ranking-item-info {
            flex: 1;
        }

        .ranking-username {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .ranking-value {
            color: #666;
            font-size: 0.9rem;
        }

        .my-ranking {
            background: #f1f8e9;
            padding: 20px;
            border-radius: 15px;
            border: 2px dashed #c8e6c9;
        }

        .my-ranking h4 {
            color: #2E7D32;
            margin-bottom: 15px;
        }

        /* ==================== æ¸¸æˆæ ·å¼ ==================== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .instruction-content {
            margin: 20px 0;
            line-height: 1.6;
        }

        .instruction-content ul {
            margin: 15px 0 15px 20px;
        }

        .instruction-content li {
            margin-bottom: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: block;
            margin: 20px auto 0;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }

        .game-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e0e0e0;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }

        .game-info {
            display: flex;
            gap: 20px;
        }

        .info-box {
            background: #f5f5f5;
            padding: 10px 20px;
            border-radius: 15px;
            text-align: center;
            min-width: 100px;
        }

        .info-box span:first-child {
            display: block;
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }

        .info-box span:last-child {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2E7D32;
        }

        .game-controls {
            display: flex;
            gap: 10px;
        }

        .game-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
            margin: 0 auto 25px;
            max-width: 600px;
        }

        .game-cell {
            aspect-ratio: 1;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.5rem;
            border: 3px solid transparent;
        }

        .game-cell:hover {
            transform: scale(1.05);
            border-color: #4CAF50;
        }

        .game-cell.selected {
            border-color: #ff9800;
            box-shadow: 0 0 15px rgba(255, 152, 0, 0.5);
        }

        .game-cell.matched {
            opacity: 0.3;
            cursor: default;
            transform: scale(0.9);
        }

        .game-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #333;
            border: 2px solid #ddd;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .current-food-info {
            flex: 1;
            margin-left: 20px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 10px;
            min-height: 60px;
            display: flex;
            align-items: center;
        }

        /* ==================== è¥å…»ä¿¡æ¯å¼¹çª— ==================== */
        .nutrition-modal {
            max-width: 400px;
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        .nutrition-content {
            padding: 20px 0;
        }

        .nutrition-food-name {
            font-size: 1.8rem;
            color: #2E7D32;
            margin-bottom: 10px;
        }

        .nutrition-korean {
            color: #666;
            font-style: italic;
            margin-bottom: 20px;
        }

        .nutrition-details {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .nutrition-details p {
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
        }

        /* ==================== åº•éƒ¨æ ·å¼ ==================== */
        .footer {
            background: #f8f9fa;
            padding: 20px 40px;
            text-align: center;
            border-top: 1px solid #eaeaea;
            color: #666;
            font-size: 0.9rem;
        }

        .hint {
            margin-top: 10px;
            color: #ff9800;
            font-size: 0.85rem;
        }

        /* ==================== å“åº”å¼è®¾è®¡ ==================== */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .features-section {
                border-right: none;
                border-bottom: 1px solid #eaeaea;
            }
            
            .features-grid {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .feature-card {
                flex: 1;
                min-width: 200px;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .stats-summary {
                grid-template-columns: 1fr;
            }
            
            .game-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .food-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .game-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .game-footer {
                flex-direction: column;
                gap: 15px;
            }
            
            .current-food-info {
                margin-left: 0;
                text-align: center;
            }
            
            .food-stat-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .food-stat-name {
                flex: 1;
            }
            
            .stat-bar {
                width: 100%;
                margin: 5px 0;
            }
            
            .food-stat-count {
                align-self: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é¡¶éƒ¨å¯¼èˆª -->
        <header class="header">
            <div class="logo">
                <h1><i class="fas fa-apple-alt"></i> å¥åº·é¥®é£ŸåŠ©æ‰‹</h1>
                <p class="subtitle">Food Shai Gama</p>
            </div>
            <div class="user-info">
                <span id="user-id-display">ç”¨æˆ·ID: åŠ è½½ä¸­...</span>
                <button id="reset-data" class="btn-small" title="é‡ç½®æ‰€æœ‰æ•°æ®">
                    <i class="fas fa-redo"></i> é‡ç½®
                </button>
            </div>
        </header>

        <!-- ä¸»å†…å®¹åŒº -->
        <main class="main-content">
            <!-- å·¦ä¾§åŠŸèƒ½åŒº -->
            <section class="features-section">
                <h2><i class="fas fa-star"></i> 2025 åŠŸèƒ½ç‰¹æ€§</h2>
                
                <div class="features-grid">
                    <div class="feature-card" id="feature-food-query">
                        <div class="feature-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3>é£Ÿç‰©æŸ¥è¯¢</h3>
                        <p>æŸ¥è¯¢30ç§éŸ©å›½é£Ÿç‰©çš„è¥å…»ä¿¡æ¯</p>
                    </div>
                    
                    <div class="feature-card" id="feature-stats">
                        <div class="feature-icon">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <h3>æ•°æ®ç»Ÿè®¡</h3>
                        <p>æŸ¥çœ‹æ‚¨çš„é¥®é£Ÿå­¦ä¹ è®°å½•</p>
                    </div>
                    
                    <div class="feature-card" id="feature-ranking">
                        <div class="feature-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <h3>æ’è¡Œæ¦œ</h3>
                        <p>æŸ¥çœ‹å­¦ä¹ æˆæœæ’å</p>
                    </div>
                    
                    <div class="feature-card" id="feature-game">
                        <div class="feature-icon">
                            <i class="fas fa-gamepad"></i>
                        </div>
                        <h3>æ¶ˆæ¶ˆä¹æ¸¸æˆ</h3>
                        <p>æ¶ˆé™¤ç›¸åŒé£Ÿç‰©ï¼Œå­¦ä¹ è¥å…»çŸ¥è¯†</p>
                    </div>
                </div>
            </section>

            <!-- å³ä¾§å†…å®¹åŒº -->
            <section class="content-section">
                <!-- é£Ÿç‰©æŸ¥è¯¢åŒºåŸŸ -->
                <div id="food-query-content" class="content-panel active">
                    <h2><i class="fas fa-search"></i> éŸ©å›½é£Ÿç‰©æŸ¥è¯¢</h2>
                    <div class="search-box">
                        <input type="text" id="food-search" placeholder="æœç´¢éŸ©å›½é£Ÿç‰©...">
                        <button id="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                    <div class="category-filter">
                        <button class="category-btn active" data-category="all">å…¨éƒ¨</button>
                        <button class="category-btn" data-category="ä¸»é£Ÿ">ä¸»é£Ÿ</button>
                        <button class="category-btn" data-category="æ±¤ç±»">æ±¤ç±»</button>
                        <button class="category-btn" data-category="å‘é…µé£Ÿå“">å‘é…µé£Ÿå“</button>
                        <button class="category-btn" data-category="æµ·é²œ">æµ·é²œ</button>
                        <button class="category-btn" data-category="è‚‰ç±»">è‚‰ç±»</button>
                        <button class="category-btn" data-category="å°åƒ">å°åƒ/ç”œç‚¹</button>
                    </div>
                    <div class="food-grid" id="food-grid">
                        <!-- é£Ÿç‰©å¡ç‰‡å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- æ•°æ®ç»Ÿè®¡åŒºåŸŸ -->
                <div id="stats-content" class="content-panel">
                    <h2><i class="fas fa-chart-bar"></i> æ•°æ®ç»Ÿè®¡</h2>
                    <div class="stats-container">
                        <div class="stats-summary">
                            <div class="stat-card">
                                <h3>æ€»ç‚¹å‡»æ¬¡æ•°</h3>
                                <p class="stat-number" id="total-clicks">0</p>
                            </div>
                            <div class="stat-card">
                                <h3>å·²å­¦ä¹ é£Ÿç‰©</h3>
                                <p class="stat-number" id="learned-foods">0/30</p>
                            </div>
                            <div class="stat-card">
                                <h3>æ€»æ¸¸æˆå¾—åˆ†</h3>
                                <p class="stat-number" id="total-score">0</p>
                            </div>
                            <div class="stat-card">
                                <h3>æœ€å¸¸ç‚¹å‡»</h3>
                                <p class="stat-number" id="most-clicked">æš‚æ— </p>
                            </div>
                        </div>
                        
                        <div class="stats-details">
                            <h3>è¯¦ç»†ç‚¹å‡»è®°å½•</h3>
                            <div class="food-stats-list" id="food-stats-list">
                                <!-- é£Ÿç‰©ç»Ÿè®¡åˆ—è¡¨å°†é€šè¿‡JSç”Ÿæˆ -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ’è¡Œæ¦œåŒºåŸŸ -->
                <div id="ranking-content" class="content-panel">
                    <h2><i class="fas fa-trophy"></i> æ’è¡Œæ¦œ</h2>
                    <div class="ranking-container">
                        <div class="ranking-tabs">
                            <button class="ranking-tab active" data-type="total">æ€»ç‚¹å‡»æ¦œ</button>
                            <button class="ranking-tab" data-type="recent">ä»Šæ—¥æ´»è·ƒæ¦œ</button>
                            <button class="ranking-tab" data-type="game">æ¸¸æˆå¾—åˆ†æ¦œ</button>
                        </div>
                        <div class="ranking-list" id="ranking-list">
                            <!-- æ’è¡Œæ¦œå°†é€šè¿‡JSç”Ÿæˆ -->
                        </div>
                        <div class="my-ranking">
                            <h4>æˆ‘çš„å­¦ä¹ è®°å½•</h4>
                            <p>æ€»ç‚¹å‡»: <span id="my-total">0</span> æ¬¡</p>
                            <p>æ¸¸æˆå¾—åˆ†: <span id="my-score">0</span> åˆ† | æ¸¸æˆæ¬¡æ•°: <span id="my-games">0</span></p>
                            <p style="color: #666; font-size: 0.9rem; margin-top: 10px;">
                                <i class="fas fa-info-circle"></i> æ’è¡Œæ¦œä»…æ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„çœŸå®æ•°æ®
                            </p>
                        </div>
                    </div>
                </div>

                <!-- æ¶ˆæ¶ˆä¹æ¸¸æˆåŒºåŸŸ -->
                <div id="game-content" class="content-panel">
                    <h2><i class="fas fa-gamepad"></i> è¥å…»çŸ¥è¯†æ¶ˆæ¶ˆä¹</h2>
                    
                    <!-- æ¸¸æˆè¯´æ˜å¼¹çª— -->
                    <div id="game-instruction-modal" class="modal active">
                        <div class="modal-content">
                            <h3><i class="fas fa-info-circle"></i> æ¶ˆæ¶ˆä¹æ¸¸æˆè¯´æ˜</h3>
                            <div class="instruction-content">
                                <p><strong>æ¸¸æˆç›®æ ‡ï¼š</strong>åœ¨é™å®šæ—¶é—´å†…ï¼Œæ¶ˆé™¤æ‰€æœ‰ç›¸é‚»çš„ç›¸åŒé£Ÿç‰©ã€‚</p>
                                <p><strong>æ¸¸æˆè§„åˆ™ï¼š</strong></p>
                                <ul>
                                    <li>ç‚¹å‡»ç›¸é‚»ï¼ˆä¸Šä¸‹å·¦å³ï¼‰çš„ä¸¤ä¸ªç›¸åŒé£Ÿç‰©å³å¯æ¶ˆé™¤</li>
                                    <li>æ¯æ¶ˆé™¤ä¸€å¯¹é£Ÿç‰©ï¼Œä¼šå¼¹å‡ºè¯¥é£Ÿç‰©çš„è¥å…»çŸ¥è¯†</li>
                                    <li>æ¶ˆé™¤è¶Šå¤šï¼Œå¾—åˆ†è¶Šé«˜</li>
                                </ul>
                                <p><strong>æ“ä½œæ–¹å¼ï¼š</strong>ç›´æ¥ç‚¹å‡»ç½‘æ ¼ä¸­çš„é£Ÿç‰©å›¾æ ‡</p>
                                <p><strong>å­¦ä¹ ç›®æ ‡ï¼š</strong>é€šè¿‡æ¸¸æˆè®¤è¯†30ç§éŸ©å›½é£Ÿç‰©çš„è¥å…»ä¿¡æ¯</p>
                            </div>
                            <button id="start-game-btn" class="btn-primary">
                                <i class="fas fa-play"></i> å¼€å§‹æ¸¸æˆ
                            </button>
                        </div>
                    </div>
                    
                    <!-- æ¸¸æˆç•Œé¢ -->
                    <div class="game-container" id="game-container" style="display: none;">
                        <div class="game-header">
                            <div class="game-info">
                                <div class="info-box">
                                    <span>æ—¶é—´:</span>
                                    <span id="game-timer">60ç§’</span>
                                </div>
                                <div class="info-box">
                                    <span>å¾—åˆ†:</span>
                                    <span id="game-score">0</span>
                                </div>
                                <div class="info-box">
                                    <span>å·²æ¶ˆé™¤:</span>
                                    <span id="game-matched">0ç»„</span>
                                </div>
                            </div>
                            <div class="game-controls">
                                <button id="restart-game" class="btn-small">
                                    <i class="fas fa-redo"></i> é‡æ–°å¼€å§‹
                                </button>
                                <button id="pause-game" class="btn-small">
                                    <i class="fas fa-pause"></i> æš‚åœ
                                </button>
                            </div>
                        </div>
                        
                        <div class="game-grid" id="game-grid">
                            <!-- æ¸¸æˆç½‘æ ¼å°†é€šè¿‡JSç”Ÿæˆ -->
                        </div>
                        
                        <div class="game-footer">
                            <button id="back-to-menu" class="btn-secondary">
                                <i class="fas fa-home"></i> è¿”å›èœå•
                            </button>
                            <div class="current-food-info" id="current-food-info">
                                <p>ç‚¹å‡»é£Ÿç‰©æŸ¥çœ‹è¥å…»ä¿¡æ¯</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- åº•éƒ¨ä¿¡æ¯ -->
        <footer class="footer">
            <p>å¥åº·é¥®é£ŸåŠ©æ‰‹ - ä¸ºéŸ©å›½é¥®é£Ÿæ–‡åŒ–è®¾è®¡ | ç‰ˆæœ¬ 1.0 | ä»…ç”¨äºæ•™å­¦å±•ç¤º</p>
            <p class="hint">æç¤ºï¼šæ‰€æœ‰æ•°æ®ä¿å­˜åœ¨æ‚¨çš„æµè§ˆå™¨æœ¬åœ°ï¼Œæ¸…é™¤æµè§ˆå™¨æ•°æ®ä¼šä¸¢å¤±å­˜æ¡£</p>
        </footer>
    </div>

    <!-- è¥å…»ä¿¡æ¯å¼¹çª— -->
    <div id="nutrition-modal" class="modal">
        <div class="modal-content nutrition-modal">
            <button id="close-nutrition" class="close-btn">&times;</button>
            <div id="nutrition-content">
                <!-- è¥å…»ä¿¡æ¯å°†é€šè¿‡JSå¡«å…… -->
            </div>
        </div>
    </div>

    <script>
        // ==================== éŸ©å›½é£Ÿç‰©æ•°æ®åº“ ====================
        const KOREAN_FOODS = [
            // ä¸»é£Ÿ (5ç§)
            { 
                id: 'rice', 
                name: 'ç™½ç±³é¥­', 
                koreanName: 'ë°¥', 
                category: 'ä¸»é£Ÿ', 
                calories: 130, 
                nutrition: 'ç¢³æ°´åŒ–åˆç‰©çš„ä¸»è¦æ¥æºï¼Œæä¾›èƒ½é‡',
                benefits: 'å¿«é€Ÿè¡¥å……èƒ½é‡ï¼Œæ˜“æ¶ˆåŒ–',
                color: '#F5E6CA',
                emoji: 'ğŸš'
            },
            { 
                id: 'bibimbap', 
                name: 'çŸ³é”…æ‹Œé¥­', 
                koreanName: 'ë¹„ë¹”ë°¥', 
                category: 'ä¸»é£Ÿ', 
                calories: 450, 
                nutrition: 'ç¢³æ°´åŒ–åˆç‰©ã€è›‹ç™½è´¨ã€ç»´ç”Ÿç´ ã€è†³é£Ÿçº¤ç»´',
                benefits: 'è¥å…»å‡è¡¡ï¼Œè”¬èœä¸°å¯Œ',
                color: '#FF9966',
                emoji: 'ğŸ¥˜'
            },
            { 
                id: 'kimbap', 
                name: 'ç´«èœåŒ…é¥­', 
                koreanName: 'ê¹€ë°¥', 
                category: 'ä¸»é£Ÿ', 
                calories: 200, 
                nutrition: 'ç¢³æ°´åŒ–åˆç‰©ã€ç¢˜ã€è†³é£Ÿçº¤ç»´ã€è›‹ç™½è´¨',
                benefits: 'è¥å…»å‡è¡¡ï¼Œæ–¹ä¾¿æºå¸¦',
                color: '#4A3728',
                emoji: 'ğŸ™'
            },
            { 
                id: 'tteok', 
                name: 'å¹´ç³•', 
                koreanName: 'ë–¡', 
                category: 'ä¸»é£Ÿ', 
                calories: 150, 
                nutrition: 'ç¢³æ°´åŒ–åˆç‰©ã€å°‘é‡è›‹ç™½è´¨',
                benefits: 'ä¼ ç»ŸèŠ‚æ—¥é£Ÿå“ï¼Œå£æ„ŸQå¼¹',
                color: '#FFFFFF',
                emoji: 'ğŸ'
            },
            { 
                id: 'japchae', 
                name: 'ç‚’æ‚èœ', 
                koreanName: 'ì¡ì±„', 
                category: 'ä¸»é£Ÿ', 
                calories: 180, 
                nutrition: 'ç¢³æ°´åŒ–åˆç‰©ã€è†³é£Ÿçº¤ç»´ã€ç»´ç”Ÿç´ ',
                benefits: 'è¤ç´ æ­é…ï¼Œè¥å…»å‡è¡¡',
                color: '#FFCC99',
                emoji: 'ğŸ¥¢'
            },
            
            // æ±¤ç±» (5ç§)
            { 
                id: 'doenjang', 
                name: 'å¤§é…±æ±¤', 
                koreanName: 'ëœì¥ì°Œê°œ', 
                category: 'æ±¤ç±»', 
                calories: 80, 
                nutrition: 'è›‹ç™½è´¨ã€ç›Šç”ŸèŒã€å¼‚é»„é…®',
                benefits: 'å‘é…µé£Ÿå“ï¼Œæœ‰ç›Šè‚ é“å¥åº·',
                color: '#8B4513',
                emoji: 'ğŸ²'
            },
            { 
                id: 'kimchi_soup', 
                name: 'æ³¡èœæ±¤', 
                koreanName: 'ê¹€ì¹˜ì°Œê°œ', 
                category: 'æ±¤ç±»', 
                calories: 90, 
                nutrition: 'ç»´ç”Ÿç´ Cã€ä¹³é…¸èŒã€è¾£æ¤’ç´ ',
                benefits: 'å¼€èƒƒï¼Œå¢å¼ºå…ç–«åŠ›',
                color: '#FF4500',
                emoji: 'ğŸŒ¶ï¸'
            },
            { 
                id: 'samgyetang', 
                name: 'å‚é¸¡æ±¤', 
                koreanName: 'ì‚¼ê³„íƒ•', 
                category: 'æ±¤ç±»', 
                calories: 250, 
                nutrition: 'è›‹ç™½è´¨ã€æ°¨åŸºé…¸ã€çŸ¿ç‰©è´¨ã€äººå‚çš‚è‹·',
                benefits: 'æ»‹è¡¥å…»ç”Ÿï¼Œæ¢å¤ä½“åŠ›',
                color: '#FFE4B5',
                emoji: 'ğŸ”'
            },
            { 
                id: 'miyeok', 
                name: 'æµ·å¸¦æ±¤', 
                koreanName: 'ë¯¸ì—­êµ­', 
                category: 'æ±¤ç±»', 
                calories: 40, 
                nutrition: 'ç¢˜ã€é’™ã€è†³é£Ÿçº¤ç»´ã€è—»èƒ¶é…¸',
                benefits: 'ç”Ÿæ—¥ä¼ ç»Ÿé£Ÿå“ï¼Œè¡¥ç¢˜ä½³å“',
                color: '#228B22',
                emoji: 'ğŸŒŠ'
            },
            { 
                id: 'kongnamul', 
                name: 'è±†èŠ½æ±¤', 
                koreanName: 'ì½©ë‚˜ë¬¼êµ­', 
                category: 'æ±¤ç±»', 
                calories: 30, 
                nutrition: 'ç»´ç”Ÿç´ Cã€è›‹ç™½è´¨ã€è†³é£Ÿçº¤ç»´',
                benefits: 'æ¸…æ·¡è§£è…»ï¼Œå¸®åŠ©æ¶ˆåŒ–',
                color: '#90EE90',
                emoji: 'ğŸŒ±'
            },
            
            // æ³¡èœç±» (5ç§)
            { 
                id: 'kimchi', 
                name: 'ç™½èœæ³¡èœ', 
                koreanName: 'ë°°ì¶”ê¹€ì¹˜', 
                category: 'å‘é…µé£Ÿå“', 
                calories: 15, 
                nutrition: 'ä¹³é…¸èŒã€ç»´ç”Ÿç´ Kã€è¾£æ¤’ç´ ã€è†³é£Ÿçº¤ç»´',
                benefits: 'éŸ©å›½å›½é£Ÿï¼Œç›Šç”ŸèŒä¸°å¯Œï¼ŒåŠ©æ¶ˆåŒ–',
                color: '#DC143C',
                emoji: 'ğŸ¥¬'
            },
            { 
                id: 'kkakdugi', 
                name: 'èåœå—æ³¡èœ', 
                koreanName: 'ê¹ë‘ê¸°', 
                category: 'å‘é…µé£Ÿå“', 
                calories: 20, 
                nutrition: 'ç»´ç”Ÿç´ Cã€è†³é£Ÿçº¤ç»´ã€ä¹³é…¸èŒ',
                benefits: 'çˆ½è„†å£æ„Ÿï¼Œè§£è…»ä½³å“',
                color: '#FF6347',
                emoji: 'ğŸ¥•'
            },
            { 
                id: 'oi_kimchi', 
                name: 'é»„ç“œæ³¡èœ', 
                koreanName: 'ì˜¤ì´ê¹€ì¹˜', 
                category: 'å‘é…µé£Ÿå“', 
                calories: 12, 
                nutrition: 'æ°´åˆ†ã€ç»´ç”Ÿç´ ã€çŸ¿ç‰©è´¨ã€ä¹³é…¸èŒ',
                benefits: 'å¤å­£æ¶ˆæš‘ï¼Œæ¸…è„†çˆ½å£',
                color: '#32CD32',
                emoji: 'ğŸ¥’'
            },
            { 
                id: 'bossam_kimchi', 
                name: 'åŒ…é¥­æ³¡èœ', 
                koreanName: 'ë³´ìŒˆê¹€ì¹˜', 
                category: 'å‘é…µé£Ÿå“', 
                calories: 25, 
                nutrition: 'å¤šç§è”¬èœç»´ç”Ÿç´ ã€ä¹³é…¸èŒ',
                benefits: 'æ­é…çƒ¤è‚‰ï¼Œè§£è…»çˆ½å£',
                color: '#FF69B4',
                emoji: 'ğŸ¥—'
            },
            { 
                id: 'young_kimchi', 
                name: 'å«©æ³¡èœ', 
                koreanName: 'ì—´ë¬´ê¹€ì¹˜', 
                category: 'å‘é…µé£Ÿå“', 
                calories: 18, 
                nutrition: 'ç»´ç”Ÿç´ ã€çŸ¿ç‰©è´¨ã€ä¹³é…¸èŒ',
                benefits: 'å£æ„Ÿé²œå«©ï¼Œå¾®é…¸å¼€èƒƒ',
                color: '#ADFF2F',
                emoji: 'ğŸŒ¿'
            },
            
            // æµ·é²œç±» (5ç§)
            { 
                id: 'mackerel', 
                name: 'çƒ¤é’èŠ±é±¼', 
                koreanName: 'ê³ ë“±ì–´êµ¬ì´', 
                category: 'æµ·é²œ', 
                calories: 180, 
                nutrition: 'Omega-3ã€è›‹ç™½è´¨ã€ç»´ç”Ÿç´ Dã€ç¡’',
                benefits: 'å¥è„‘ç›Šæ™ºï¼Œä¿æŠ¤å¿ƒè¡€ç®¡',
                color: '#4682B4',
                emoji: 'ğŸŸ'
            },
            { 
                id: 'sannakji', 
                name: 'ç”Ÿæ‹Œç« é±¼', 
                koreanName: 'ì‚°ë‚™ì§€', 
                category: 'æµ·é²œ', 
                calories: 70, 
                nutrition: 'è›‹ç™½è´¨ã€ç‰›ç£ºé…¸ã€é”Œã€ç¡’',
                benefits: 'é«˜è›‹ç™½ä½è„‚è‚ªï¼Œå£æ„Ÿç‹¬ç‰¹',
                color: '#8A2BE2',
                emoji: 'ğŸ™'
            },
            { 
                id: 'ganjang_gejang', 
                name: 'é…±èƒèŸ¹', 
                koreanName: 'ê°„ì¥ê²Œì¥', 
                category: 'æµ·é²œ', 
                calories: 90, 
                nutrition: 'è›‹ç™½è´¨ã€é’™ã€ç”²å£³ç´ ã€é”Œ',
                benefits: 'ä¼ ç»Ÿç¾å‘³ï¼Œè¡¥é’™ä½³å“',
                color: '#5F9EA0',
                emoji: 'ğŸ¦€'
            },
            { 
                id: 'jang_eo', 
                name: 'çƒ¤é³—é±¼', 
                koreanName: 'ì¥ì–´êµ¬ì´', 
                category: 'æµ·é²œ', 
                calories: 250, 
                nutrition: 'ç»´ç”Ÿç´ Aã€Eã€DHAã€EPA',
                benefits: 'æ»‹è¡¥å¼ºèº«ï¼Œç¾å®¹å…»é¢œ',
                color: '#A52A2A',
                emoji: 'ğŸ'
            },
            { 
                id: 'galchi', 
                name: 'è¾£ç‚–å¸¦é±¼', 
                koreanName: 'ê°ˆì¹˜ì¡°ë¦¼', 
                category: 'æµ·é²œ', 
                calories: 150, 
                nutrition: 'è›‹ç™½è´¨ã€ä¸é¥±å’Œè„‚è‚ªé…¸ã€é’™',
                benefits: 'å®¶å¸¸ç¾å‘³ï¼Œè¥å…»ä¸°å¯Œ',
                color: '#D2691E',
                emoji: 'ğŸ£'
            },
            
            // è‚‰ç±» (5ç§)
            { 
                id: 'samgyeopsal', 
                name: 'çƒ¤äº”èŠ±è‚‰', 
                koreanName: 'ì‚¼ê²¹ì‚´', 
                category: 'è‚‰ç±»', 
                calories: 300, 
                nutrition: 'è›‹ç™½è´¨ã€è„‚è‚ªã€ç»´ç”Ÿç´ Bæ—',
                benefits: 'ç¤¾äº¤ç¾é£Ÿï¼Œæ­é…ç”Ÿèœæ›´å¥åº·',
                color: '#FFD700',
                emoji: 'ğŸ¥“'
            },
            { 
                id: 'galbi', 
                name: 'çƒ¤ç‰›æ’éª¨', 
                koreanName: 'ê°ˆë¹„', 
                category: 'è‚‰ç±»', 
                calories: 280, 
                nutrition: 'ä¼˜è´¨è›‹ç™½è´¨ã€é“ã€é”Œã€ç»´ç”Ÿç´ B12',
                benefits: 'è¡¥å……é“è´¨ï¼Œå¢å¼ºä½“åŠ›',
                color: '#8B0000',
                emoji: 'ğŸ¥©'
            },
            { 
                id: 'bulgogi', 
                name: 'çƒ¤ç‰›è‚‰', 
                koreanName: 'ë¶ˆê³ ê¸°', 
                category: 'è‚‰ç±»', 
                calories: 220, 
                nutrition: 'ä¼˜è´¨è›‹ç™½è´¨ã€é“ã€é”Œã€æ°¨åŸºé…¸',
                benefits: 'ä½è„‚è‚ªé«˜è›‹ç™½ï¼Œç¾å‘³å¥åº·',
                color: '#B22222',
                emoji: 'ğŸ”¥'
            },
            { 
                id: 'dakgangjeong', 
                name: 'éŸ©å¼ç‚¸é¸¡', 
                koreanName: 'ë‹­ê°•ì •', 
                category: 'è‚‰ç±»', 
                calories: 280, 
                nutrition: 'è›‹ç™½è´¨ã€ç¢³æ°´åŒ–åˆç‰©ã€è„‚è‚ª',
                benefits: 'æµè¡Œç¾é£Ÿï¼Œé€‚é‡äº«ç”¨',
                color: '#DAA520',
                emoji: 'ğŸ—'
            },
            { 
                id: 'bossam', 
                name: 'æ°´ç…®è‚‰ç‰‡', 
                koreanName: 'ë³´ìŒˆ', 
                category: 'è‚‰ç±»', 
                calories: 200, 
                nutrition: 'è›‹ç™½è´¨ã€èƒ¶åŸè›‹ç™½ã€ç»´ç”Ÿç´ ',
                benefits: 'è‚‰è´¨é²œå«©ï¼Œæ­é…æ³¡èœ',
                color: '#F0E68C',
                emoji: 'ğŸ–'
            },
            
            // å°åƒç”œç‚¹ (5ç§)
            { 
                id: 'tteokbokki', 
                name: 'ç‚’å¹´ç³•', 
                koreanName: 'ë–¡ë³¶ì´', 
                category: 'å°åƒ', 
                calories: 200, 
                nutrition: 'ç¢³æ°´åŒ–åˆç‰©ã€å°‘é‡è›‹ç™½è´¨ã€è¾£æ¤’ç´ ',
                benefits: 'è¡—å¤´ç¾é£Ÿï¼Œè¾£ä¸­å¸¦ç”œ',
                color: '#FF1493',
                emoji: 'ğŸ¡'
            },
            { 
                id: 'hotteok', 
                name: 'ç³–é¥¼', 
                koreanName: 'í˜¸ë–¡', 
                category: 'å°åƒ', 
                calories: 150, 
                nutrition: 'ç¢³æ°´åŒ–åˆç‰©ã€ç³–åˆ†',
                benefits: 'å†¬å­£æš–æ‰‹ç¾é£Ÿï¼Œç”œè€Œä¸è…»',
                color: '#DEB887',
                emoji: 'ğŸ¥®'
            },
            { 
                id: 'bungeoppang', 
                name: 'é²«é±¼é¥¼', 
                koreanName: 'ë¶•ì–´ë¹µ', 
                category: 'å°åƒ', 
                calories: 120, 
                nutrition: 'ç¢³æ°´åŒ–åˆç‰©ã€çº¢è±†è¥å…»',
                benefits: 'å†¬å­£è¡—å¤´å°åƒï¼Œæ¸©æš–ç”œèœœ',
                color: '#CD853F',
                emoji: 'ğŸ '
            },
            { 
                id: 'patbingsu', 
                name: 'çº¢è±†åˆ¨å†°', 
                koreanName: 'íŒ¥ë¹™ìˆ˜', 
                category: 'ç”œç‚¹', 
                calories: 300, 
                nutrition: 'ç¢³æ°´åŒ–åˆç‰©ã€è›‹ç™½è´¨ã€é’™',
                benefits: 'å¤å­£æ¶ˆæš‘ç”œå“',
                color: '#FFB6C1',
                emoji: 'ğŸ§'
            },
            { 
                id: 'yujacha', 
                name: 'æŸšå­èŒ¶', 
                koreanName: 'ìœ ìì°¨', 
                category: 'é¥®å“', 
                calories: 50, 
                nutrition: 'ç»´ç”Ÿç´ Cã€æŸšå­è‹·',
                benefits: 'æ¶¦å–‰æ­¢å’³ï¼Œå†¬å­£æš–é¥®',
                color: '#FFD700',
                emoji: 'ğŸ¯'
            }
        ];

        // ==================== å¥åº·é¥®é£ŸåŠ©æ‰‹åº”ç”¨ ====================
        class HealthFoodAssistant {
            constructor() {
                this.userId = this.getOrCreateUserId();
                this.userData = this.loadUserData();
                this.foodTracker = new FoodTracker(this);
                this.game = null;
                this.currentPanel = 'food-query';
                this.saveTimeout = null;
                
                this.initialize();
            }
            
            // è·å–æˆ–åˆ›å»ºç”¨æˆ·ID
            getOrCreateUserId() {
                let userId = localStorage.getItem('hfa_user_id');
                if (!userId) {
                    // ç”Ÿæˆå”¯ä¸€IDï¼šæ—¶é—´æˆ³ + éšæœºå­—ç¬¦ä¸²
                    userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    localStorage.setItem('hfa_user_id', userId);
                    console.log('ğŸ†• åˆ›å»ºæ–°ç”¨æˆ·ID:', userId);
                }
                return userId;
            }
            
            // åŠ è½½ç”¨æˆ·æ•°æ®
            loadUserData() {
                const key = `hfa_data_${this.userId}`;
                const saved = localStorage.getItem(key);
                
                if (saved) {
                    const data = JSON.parse(saved);
                    console.log('ğŸ“‚ åŠ è½½ç”¨æˆ·æ•°æ®:', data.profile.userId);
                    return data;
                } else {
                    console.log('ğŸ†• åˆ›å»ºæ–°ç”¨æˆ·æ•°æ®');
                    return this.createInitialData();
                }
            }
            
            // åˆ›å»ºåˆå§‹æ•°æ®
            createInitialData() {
                // åˆå§‹åŒ–æ‰€æœ‰é£Ÿç‰©çš„ç‚¹å‡»æ¬¡æ•°ä¸º0
                const foodClicks = {};
                KOREAN_FOODS.forEach(food => {
                    foodClicks[food.id] = 0;
                });
                
                return {
                    profile: {
                        userId: this.userId,
                        joinDate: new Date().toISOString(),
                        lastActive: new Date().toISOString(),
                        username: `ç”¨æˆ·${this.userId.substr(5, 4)}`
                    },
                    stats: {
                        totalGames: 0,
                        totalScore: 0,
                        bestScore: 0,
                        totalTime: 0,
                        foodClicks: foodClicks
                    },
                    gameProgress: {
                        currentLevel: 1,
                        unlockedLevels: [1],
                        achievements: [],
                        lastPlayed: null
                    },
                    preferences: {
                        sound: true,
                        language: 'zh',
                        difficulty: 'normal'
                    }
                };
            }
            
            // ä¿å­˜ç”¨æˆ·æ•°æ®
            saveUserData() {
                const key = `hfa_data_${this.userId}`;
                this.userData.profile.lastActive = new Date().toISOString();
                
                localStorage.setItem(key, JSON.stringify(this.userData));
                console.log('ğŸ’¾ ç”¨æˆ·æ•°æ®å·²ä¿å­˜');
                return true;
            }
            
            // è‡ªåŠ¨ä¿å­˜ï¼ˆé˜²æŠ–ï¼‰
            autoSave() {
                if (this.saveTimeout) clearTimeout(this.saveTimeout);
                this.saveTimeout = setTimeout(() => {
                    this.saveUserData();
                }, 1000);
            }
            
            // é‡ç½®æ‰€æœ‰æ•°æ®
            resetData() {
                if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ•°æ®å—ï¼Ÿè¿™å°†æ¸…é™¤æ‚¨çš„æ‰€æœ‰æ¸¸æˆè¿›åº¦å’Œç»Ÿè®¡ä¿¡æ¯ã€‚')) {
                    localStorage.removeItem(`hfa_data_${this.userId}`);
                    localStorage.removeItem('hfa_user_id');
                    
                    // åˆ·æ–°é¡µé¢é‡æ–°åˆå§‹åŒ–
                    location.reload();
                }
            }
            
            // åˆå§‹åŒ–åº”ç”¨
            initialize() {
                console.log('ğŸš€ å¥åº·é¥®é£ŸåŠ©æ‰‹å¯åŠ¨');
                console.log('ğŸ‘¤ å½“å‰ç”¨æˆ·:', this.userData.profile.username);
                console.log('ğŸ“Š å½“å‰ç»Ÿè®¡:', this.foodTracker.getStatsReport());
                
                // æ›´æ–°ç”¨æˆ·IDæ˜¾ç¤º
                document.getElementById('user-id-display').textContent = 
                    `ç”¨æˆ·: ${this.userData.profile.username}`;
                
                // åˆå§‹åŒ–UI
                this.setupEventListeners();
                this.renderFoodGrid();
                this.updateStatsDisplay();
                this.updateRankingDisplay();
                
                // æ˜¾ç¤ºé£Ÿç‰©æŸ¥è¯¢é¢æ¿
                this.switchPanel('food-query');
            }
            
            // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
            setupEventListeners() {
                // åŠŸèƒ½åŒºå¡ç‰‡ç‚¹å‡»
                document.querySelectorAll('.feature-card').forEach(card => {
                    card.addEventListener('click', (e) => {
                        const panel = card.id.replace('feature-', '');
                        this.switchPanel(panel);
                    });
                });
                
                // é£Ÿç‰©æœç´¢
                document.getElementById('search-btn').addEventListener('click', () => {
                    this.searchFoods();
                });
                
                document.getElementById('food-search').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.searchFoods();
                });
                
                // åˆ†ç±»ç­›é€‰
                document.querySelectorAll('.category-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.renderFoodGrid();
                    });
                });
                
                // é‡ç½®æ•°æ®æŒ‰é’®
                document.getElementById('reset-data').addEventListener('click', () => {
                    this.resetData();
                });
                
                // æ’è¡Œæ¦œæ ‡ç­¾åˆ‡æ¢
                document.querySelectorAll('.ranking-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        document.querySelectorAll('.ranking-tab').forEach(t => t.classList.remove('active'));
                        e.target.classList.add('active');
                        this.updateRankingDisplay();
                    });
                });
                
                // è¥å…»ä¿¡æ¯å¼¹çª—å…³é—­
                document.getElementById('close-nutrition').addEventListener('click', () => {
                    this.hideNutritionModal();
                });
                
                // ç‚¹å‡»èƒŒæ™¯å…³é—­å¼¹çª—
                document.getElementById('nutrition-modal').addEventListener('click', (e) => {
                    if (e.target.id === 'nutrition-modal') {
                        this.hideNutritionModal();
                    }
                });
            }
            
            // åˆ‡æ¢å†…å®¹é¢æ¿
            switchPanel(panelName) {
                // æ›´æ–°å½“å‰é¢æ¿
                this.currentPanel = panelName;
                
                // æ›´æ–°åŠŸèƒ½åŒºå¡ç‰‡çŠ¶æ€
                document.querySelectorAll('.feature-card').forEach(card => {
                    card.classList.remove('active');
                });
                document.getElementById(`feature-${panelName}`).classList.add('active');
                
                // æ˜¾ç¤ºå¯¹åº”å†…å®¹é¢æ¿
                document.querySelectorAll('.content-panel').forEach(panel => {
                    panel.classList.remove('active');
                });
                document.getElementById(`${panelName}-content`).classList.add('active');
                
                // ç‰¹æ®Šå¤„ç†æ¸¸æˆé¢æ¿
                if (panelName === 'game') {
                    this.showGameInstruction();
                }
            }
            
            // æ¸²æŸ“é£Ÿç‰©ç½‘æ ¼
            renderFoodGrid() {
                const foodGrid = document.getElementById('food-grid');
                const searchTerm = document.getElementById('food-search').value.toLowerCase();
                const activeCategory = document.querySelector('.category-btn.active').dataset.category;
                
                // ç­›é€‰é£Ÿç‰©
                const filteredFoods = KOREAN_FOODS.filter(food => {
                    const matchesSearch = !searchTerm || 
                        food.name.toLowerCase().includes(searchTerm) || 
                        food.koreanName.toLowerCase().includes(searchTerm);
                    
                    const matchesCategory = activeCategory === 'all' || food.category === activeCategory;
                    
                    return matchesSearch && matchesCategory;
                });
                
                // æ¸…ç©ºç½‘æ ¼
                foodGrid.innerHTML = '';
                
                // æ¸²æŸ“é£Ÿç‰©å¡ç‰‡
                filteredFoods.forEach(food => {
                    const foodCard = document.createElement('div');
                    foodCard.className = 'food-card';
                    foodCard.dataset.foodId = food.id;
                    foodCard.dataset.foodName = food.name;
                    
                    const clickCount = this.userData.stats.foodClicks[food.id] || 0;
                    
                    foodCard.innerHTML = `
                        <div class="food-color" style="background-color: ${food.color}">
                            <span style="font-size: 2.5rem;">${food.emoji}</span>
                        </div>
                        <div class="food-info">
                            <h3>${food.name}</h3>
                            <p class="food-korean">${food.koreanName}</p>
                            <div class="food-meta">
                                <span>${food.category}</span>
                                <span>${food.calories} kcal</span>
                            </div>
                            <p class="click-count">ç‚¹å‡»æ¬¡æ•°: ${clickCount}</p>
                        </div>
                    `;
                    
                    // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                    foodCard.addEventListener('click', () => {
                        this.handleFoodClick(food.id, food.name);
                        this.showNutritionInfo(food);
                    });
                    
                    foodGrid.appendChild(foodCard);
                });
                
                // å¦‚æœæ²¡æœ‰åŒ¹é…çš„é£Ÿç‰©
                if (filteredFoods.length === 0) {
                    foodGrid.innerHTML = `
                        <div class="no-results">
                            <i class="fas fa-search" style="font-size: 3rem; color: #ccc; margin-bottom: 15px;"></i>
                            <h3>æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„é£Ÿç‰©</h3>
                            <p>è¯·å°è¯•å…¶ä»–æœç´¢è¯æˆ–åˆ†ç±»</p>
                        </div>
                    `;
                }
            }
            
            // æœç´¢é£Ÿç‰©
            searchFoods() {
                this.renderFoodGrid();
            }
            
            // å¤„ç†é£Ÿç‰©ç‚¹å‡»
            handleFoodClick(foodId, foodName) {
                const success = this.foodTracker.recordClick(foodId, foodName);
                if (success) {
                    this.updateStatsDisplay();
                    this.updateRankingDisplay();
                    
                    // æ›´æ–°å½“å‰é£Ÿç‰©çš„ç‚¹å‡»æ˜¾ç¤º
                    const foodCard = document.querySelector(`.food-card[data-food-id="${foodId}"] .click-count`);
                    if (foodCard) {
                        const newCount = this.userData.stats.foodClicks[foodId] || 0;
                        foodCard.textContent = `ç‚¹å‡»æ¬¡æ•°: ${newCount}`;
                    }
                }
            }
            
            // æ˜¾ç¤ºè¥å…»ä¿¡æ¯
            showNutritionInfo(food) {
                const modal = document.getElementById('nutrition-modal');
                const content = document.getElementById('nutrition-content');
                
                const clickCount = this.userData.stats.foodClicks[food.id] || 0;
                
                content.innerHTML = `
                    <div class="nutrition-food-name">
                        ${food.emoji} ${food.name}
                    </div>
                    <div class="nutrition-korean">${food.koreanName}</div>
                    
                    <div class="nutrition-details">
                        <p><strong>ç±»åˆ«:</strong> ${food.category}</p>
                        <p><strong>çƒ­é‡:</strong> ${food.calories} åƒå¡/ä»½</p>
                        <p><strong>ä¸»è¦è¥å…»:</strong> ${food.nutrition}</p>
                        <p><strong>å¥åº·ç›Šå¤„:</strong> ${food.benefits}</p>
                        <p><strong>æ‚¨çš„ç‚¹å‡»æ¬¡æ•°:</strong> ${clickCount} æ¬¡</p>
                    </div>
                `;
                
                modal.classList.add('active');
            }
            
            // éšè—è¥å…»ä¿¡æ¯å¼¹çª—
            hideNutritionModal() {
                document.getElementById('nutrition-modal').classList.remove('active');
            }
            
            // æ›´æ–°ç»Ÿè®¡æ˜¾ç¤º
            updateStatsDisplay() {
                const stats = this.foodTracker.getStatsReport();
                
                // æ›´æ–°æ‘˜è¦æ•°æ®
                document.getElementById('total-clicks').textContent = stats.totalClicks;
                document.getElementById('learned-foods').textContent = `${stats.learnedFoods}/${KOREAN_FOODS.length}`;
                document.getElementById('total-score').textContent = this.userData.stats.totalScore;
                
                if (stats.mostClicked) {
                    document.getElementById('most-clicked').textContent = 
                        `${stats.mostClicked.name} (${stats.mostClicked.count}æ¬¡)`;
                } else {
                    document.getElementById('most-clicked').textContent = 'æš‚æ— ';
                }
                
                // æ›´æ–°è¯¦ç»†ç»Ÿè®¡åˆ—è¡¨
                const statsList = document.getElementById('food-stats-list');
                statsList.innerHTML = '';
                
                // åªæ˜¾ç¤ºç‚¹å‡»è¿‡çš„é£Ÿç‰©
                const clickedFoods = Object.entries(this.userData.stats.foodClicks)
                    .filter(([foodId, count]) => count > 0)
                    .sort((a, b) => b[1] - a[1]);
                
                if (clickedFoods.length === 0) {
                    statsList.innerHTML = `
                        <div class="no-stats">
                            <i class="fas fa-chart-line" style="font-size: 2rem; color: #ccc; margin-bottom: 10px;"></i>
                            <p>æš‚æ— æ•°æ®ï¼Œè¯·ç‚¹å‡»é£Ÿç‰©å¼€å§‹å­¦ä¹ </p>
                        </div>
                    `;
                    return;
                }
                
                // æ‰¾åˆ°æœ€å¤§ç‚¹å‡»æ¬¡æ•°ç”¨äºè®¡ç®—ç™¾åˆ†æ¯”
                const maxClicks = Math.max(...clickedFoods.map(([_, count]) => count));
                
                clickedFoods.forEach(([foodId, count]) => {
                    const food = KOREAN_FOODS.find(f => f.id === foodId);
                    if (!food) return;
                    
                    const percentage = (count / maxClicks) * 100;
                    
                    const statItem = document.createElement('div');
                    statItem.className = 'food-stat-item';
                    statItem.innerHTML = `
                        <div class="food-stat-name">
                            ${food.emoji} ${food.name}
                        </div>
                        <div class="stat-bar">
                            <div class="stat-bar-fill" style="width: ${percentage}%"></div>
                        </div>
                        <div class="food-stat-count">
                            ${count} æ¬¡
                        </div>
                    `;
                    
                    statsList.appendChild(statItem);
                });
            }
            
            // æ›´æ–°æ’è¡Œæ¦œæ˜¾ç¤º
            updateRankingDisplay() {
                const rankingList = document.getElementById('ranking-list');
                rankingList.innerHTML = '';
                
                // è·å–å½“å‰ç”¨æˆ·æ•°æ®
                const myStats = this.foodTracker.getStatsReport();
                
                // è®¡ç®—ä»Šæ—¥ç‚¹å‡»ï¼ˆæ¨¡æ‹Ÿï¼šè¿‡å»24å°æ—¶å†…çš„ç‚¹å‡»ï¼‰
                // è¿™é‡Œä¸ºäº†ç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨æ€»ç‚¹å‡»æ•°çš„1/3ä½œä¸ºæ¨¡æ‹Ÿä»Šæ—¥ç‚¹å‡»
                const todayClicks = Math.floor(myStats.totalClicks / 3);
                
                // åªæ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„æ•°æ®
                const allUsers = [{
                    username: this.userData.profile.username,
                    totalClicks: myStats.totalClicks,
                    todayClicks: todayClicks,
                    gameScore: this.userData.stats.totalScore
                }];
                
                // è·å–å½“å‰æ’è¡Œæ¦œç±»å‹
                const rankingType = document.querySelector('.ranking-tab.active').dataset.type;
                
                // ç”Ÿæˆæ’è¡Œæ¦œï¼ˆåªæœ‰ä¸€ä¸ªç”¨æˆ·ï¼‰
                allUsers.forEach((user, index) => {
                    const rankingItem = document.createElement('div');
                    rankingItem.className = 'ranking-item';
                    
                    // åªæœ‰ä¸€ä¸ªç”¨æˆ·ï¼Œæ˜¾ç¤ºé‡‘è‰²
                    let rankClass = 'gold';
                    
                    const displayValue = rankingType === 'total' ? user.totalClicks :
                                       rankingType === 'recent' ? user.todayClicks :
                                       user.gameScore;
                    
                    const displayUnit = rankingType === 'game' ? 'åˆ†' : 'æ¬¡';
                    
                    rankingItem.innerHTML = `
                        <div class="rank-number ${rankClass}">${index + 1}</div>
                        <div class="ranking-item-info">
                            <div class="ranking-username">${user.username}</div>
                            <div class="ranking-value">${displayValue}${displayUnit}</div>
                        </div>
                    `;
                    
                    rankingList.appendChild(rankingItem);
                });
                
                // æ›´æ–°æˆ‘çš„æ’åä¿¡æ¯
                document.getElementById('my-total').textContent = myStats.totalClicks;
                document.getElementById('my-rank').textContent = '1'; // åªæœ‰ä¸€ä¸ªç”¨æˆ·ï¼Œæ€»æ˜¯ç¬¬ä¸€å
                document.getElementById('my-score').textContent = this.userData.stats.totalScore;
                document.getElementById('my-games').textContent = this.userData.stats.totalGames || 0;
            }
            
            // ==================== æ¸¸æˆç›¸å…³åŠŸèƒ½ ====================
            
            // æ˜¾ç¤ºæ¸¸æˆè¯´æ˜
            showGameInstruction() {
                document.getElementById('game-instruction-modal').classList.add('active');
                document.getElementById('game-container').style.display = 'none';
            }
            
            // å¼€å§‹æ¸¸æˆ
            startGame() {
                document.getElementById('game-instruction-modal').classList.remove('active');
                document.getElementById('game-container').style.display = 'block';
                
                if (!this.game) {
                    this.game = new MatchGame(this);
                }
                
                this.game.start();
            }
            
            // æš‚åœæ¸¸æˆ
            pauseGame() {
                if (this.game) {
                    this.game.pause();
                }
            }
            
            // é‡æ–°å¼€å§‹æ¸¸æˆ
            restartGame() {
                if (this.game) {
                    this.game.restart();
                }
            }
            
            // è¿”å›èœå•
            backToMenu() {
                if (this.game) {
                    this.game.stop();
                }
                this.showGameInstruction();
            }
        }

        // ==================== é£Ÿç‰©è¿½è¸ªå™¨ï¼ˆä¿®å¤äº†é‡å¤ç‚¹å‡»Bugï¼‰ ====================
        class FoodTracker {
            constructor(app) {
                this.app = app;
                this.lastClickTime = 0;
                this.clickCooldown = 500; // 500mså†…ä¸é‡å¤è®°å½•
                this.lastClickedFood = null;
            }
            
            // è®°å½•é£Ÿç‰©ç‚¹å‡»ï¼ˆç»å¯¹é˜²æ­¢é‡å¤ï¼‰
            recordClick(foodId, foodName) {
                const now = Date.now();
                
                // é˜²å¾¡1ï¼šå†·å´æ—¶é—´æ£€æŸ¥ï¼ˆé˜²æ­¢å¿«é€Ÿè¿ç»­ç‚¹å‡»ï¼‰
                if (now - this.lastClickTime < this.clickCooldown && this.lastClickedFood === foodId) {
                    console.log(`â³ ç‚¹å‡»è¿‡å¿«ï¼Œå¿½ç•¥: ${foodName}`);
                    return false;
                }
                
                // é˜²å¾¡2ï¼šæ›´æ–°ç‚¹å‡»æ—¶é—´
                this.lastClickTime = now;
                this.lastClickedFood = foodId;
                
                // é˜²å¾¡3ï¼šç¡®ä¿æ•°æ®å­˜åœ¨
                if (!this.app.userData.stats.foodClicks[foodId]) {
                    this.app.userData.stats.foodClicks[foodId] = 0;
                }
                
                // è®°å½•ç‚¹å‡»ï¼ˆåªåŠ 1æ¬¡ï¼ï¼‰
                const oldCount = this.app.userData.stats.foodClicks[foodId];
                this.app.userData.stats.foodClicks[foodId] = oldCount + 1;
                
                // æ›´æ–°æ€»åˆ†ï¼ˆæ¯æ¬¡ç‚¹å‡»åŠ 10åˆ†ï¼‰
                this.app.userData.stats.totalScore += 10;
                
                // è§¦å‘è‡ªåŠ¨ä¿å­˜
                this.app.autoSave();
                
                console.log(`âœ… ${foodName}: ${oldCount} â†’ ${oldCount + 1}æ¬¡ç‚¹å‡»`);
                return true;
            }
            
            // è·å–ç»Ÿè®¡æŠ¥å‘Š
            getStatsReport() {
                const clicks = this.app.userData.stats.foodClicks;
                const totalClicks = Object.values(clicks).reduce((a, b) => a + b, 0);
                
                // è®¡ç®—å­¦ä¹ è¿‡çš„é£Ÿç‰©æ•°é‡ï¼ˆç‚¹å‡»æ¬¡æ•°>0ï¼‰
                const learnedFoods = Object.values(clicks).filter(count => count > 0).length;
                
                return {
                    totalClicks,
                    learnedFoods,
                    mostClicked: this.getMostClickedFood(),
                    foodDetails: this.getFoodDetails()
                };
            }
            
            // è·å–æœ€å¸¸ç‚¹å‡»çš„é£Ÿç‰©
            getMostClickedFood() {
                const clicks = this.app.userData.stats.foodClicks;
                let max = 0;
                let maxFoodId = null;
                
                Object.entries(clicks).forEach(([foodId, count]) => {
                    if (count > max) {
                        max = count;
                        maxFoodId = foodId;
                    }
                });
                
                if (!maxFoodId || max === 0) return null;
                
                const food = KOREAN_FOODS.find(f => f.id === maxFoodId);
                return food ? {
                    id: maxFoodId,
                    name: food.name,
                    count: max
                } : null;
            }
            
            // è·å–é£Ÿç‰©è¯¦æƒ…ç»Ÿè®¡
            getFoodDetails() {
                const details = [];
                const clicks = this.app.userData.stats.foodClicks;
                
                Object.entries(clicks).forEach(([foodId, count]) => {
                    if (count > 0) {
                        const food = KOREAN_FOODS.find(f => f.id === foodId);
                        if (food) {
                            details.push({
                                id: foodId,
                                name: food.name,
                                count: count,
                                category: food.category
                            });
                        }
                    }
                });
                
                return details.sort((a, b) => b.count - a.count);
            }
        }

        // ==================== æ¶ˆæ¶ˆä¹æ¸¸æˆ ====================
        class MatchGame {
            constructor(app) {
                this.app = app;
                this.gridSize = 6;
                this.timer = 60;
                this.score = 0;
                this.matchedPairs = 0;
                this.selected = null;
                this.grid = [];
                this.isPlaying = false;
                this.gameInterval = null;
                
                this.initialize();
            }
            
            // åˆå§‹åŒ–æ¸¸æˆ
            initialize() {
                this.createGrid();
                this.renderGrid();
                this.setupGameControls();
            }
            
            // åˆ›å»ºæ¸¸æˆç½‘æ ¼
            createGrid() {
                this.grid = [];
                
                // é€‰æ‹©12ç§é£Ÿç‰©ç”¨äºæ¸¸æˆï¼ˆé¿å…å¤ªå¤šç§ç±»ï¼‰
                const gameFoods = KOREAN_FOODS.slice(0, 12);
                
                // ç¡®ä¿æ¯ç§é£Ÿç‰©å‡ºç°å¶æ•°æ¬¡
                const totalCells = this.gridSize * this.gridSize;
                const pairsNeeded = totalCells / 2;
                
                // åˆ›å»ºé£Ÿç‰©å¯¹
                const foodPairs = [];
                for (let i = 0; i < pairsNeeded; i++) {
                    const food = gameFoods[i % gameFoods.length];
                    foodPairs.push(food, food);
                }
                
                // éšæœºæ‰“ä¹±é¡ºåº
                for (let i = foodPairs.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [foodPairs[i], foodPairs[j]] = [foodPairs[j], foodPairs[i]];
                }
                
                // åˆ›å»ºç½‘æ ¼
                for (let i = 0; i < totalCells; i++) {
                    this.grid.push({
                        id: foodPairs[i].id,
                        name: foodPairs[i].name,
                        emoji: foodPairs[i].emoji,
                        color: foodPairs[i].color,
                        matched: false,
                        index: i
                    });
                }
            }
            
            // æ¸²æŸ“æ¸¸æˆç½‘æ ¼
            renderGrid() {
                const gameGrid = document.getElementById('game-grid');
                gameGrid.innerHTML = '';
                
                this.grid.forEach((cell, index) => {
                    const cellElement = document.createElement('div');
                    cellElement.className = 'game-cell';
                    cellElement.dataset.index = index;
                    
                    if (cell.matched) {
                        cellElement.classList.add('matched');
                        cellElement.innerHTML = 'âœ…';
                    } else {
                        cellElement.style.backgroundColor = cell.color;
                        cellElement.innerHTML = cell.emoji;
                        
                        if (this.selected === index) {
                            cellElement.classList.add('selected');
                        }
                    }
                    
                    cellElement.addEventListener('click', () => this.handleCellClick(index));
                    gameGrid.appendChild(cellElement);
                });
            }
            
            // å¤„ç†å•å…ƒæ ¼ç‚¹å‡»
            handleCellClick(index) {
                if (!this.isPlaying || this.grid[index].matched) return;
                
                // å¦‚æœæ²¡æœ‰é€‰ä¸­çš„å•å…ƒæ ¼ï¼Œé€‰ä¸­å½“å‰å•å…ƒæ ¼
                if (this.selected === null) {
                    this.selected = index;
                    this.renderGrid();
                    return;
                }
                
                // å¦‚æœå·²ç»é€‰ä¸­ä¸€ä¸ªå•å…ƒæ ¼ï¼Œæ£€æŸ¥æ˜¯å¦åŒ¹é…
                const firstCell = this.grid[this.selected];
                const secondCell = this.grid[index];
                
                // ä¸èƒ½ç‚¹å‡»åŒä¸€ä¸ªå•å…ƒæ ¼
                if (this.selected === index) return;
                
                // æ£€æŸ¥æ˜¯å¦åŒ¹é…
                if (firstCell.id === secondCell.id) {
                    // åŒ¹é…æˆåŠŸ
                    this.grid[this.selected].matched = true;
                    this.grid[index].matched = true;
                    
                    this.matchedPairs++;
                    this.score += 100;
                    
                    // è®°å½•é£Ÿç‰©ç‚¹å‡»
                    this.app.foodTracker.recordClick(firstCell.id, firstCell.name);
                    
                    // æ˜¾ç¤ºè¥å…»ä¿¡æ¯
                    const food = KOREAN_FOODS.find(f => f.id === firstCell.id);
                    if (food) {
                        this.showCurrentFoodInfo(food);
                    }
                    
                    // æ›´æ–°æ˜¾ç¤º
                    this.updateGameDisplay();
                    this.renderGrid();
                    
                    // æ£€æŸ¥æ¸¸æˆæ˜¯å¦ç»“æŸ
                    if (this.matchedPairs === (this.gridSize * this.gridSize) / 2) {
                        this.gameWin();
                    }
                } else {
                    // ä¸åŒ¹é…ï¼Œæ˜¾ç¤ºçŸ­æš‚æ•ˆæœåæ¢å¤
                    this.renderGrid();
                    
                    setTimeout(() => {
                        this.selected = null;
                        this.renderGrid();
                    }, 500);
                }
                
                this.selected = null;
            }
            
            // æ˜¾ç¤ºå½“å‰é£Ÿç‰©ä¿¡æ¯
            showCurrentFoodInfo(food) {
                const infoBox = document.getElementById('current-food-info');
                const clickCount = this.app.userData.stats.foodClicks[food.id] || 0;
                
                infoBox.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 1.5rem;">${food.emoji}</span>
                        <div>
                            <strong>${food.name}</strong> (${food.koreanName})<br>
                            <small>${food.nutrition}</small><br>
                            <small>æ‚¨å·²ç‚¹å‡»: ${clickCount}æ¬¡</small>
                        </div>
                    </div>
                `;
            }
            
            // æ›´æ–°æ¸¸æˆæ˜¾ç¤º
            updateGameDisplay() {
                document.getElementById('game-score').textContent = this.score;
                document.getElementById('game-matched').textContent = `${this.matchedPairs}ç»„`;
                document.getElementById('game-timer').textContent = `${this.timer}ç§’`;
                
                // æ›´æ–°åº”ç”¨ç»Ÿè®¡æ•°æ®
                this.app.userData.stats.totalScore = this.app.userData.stats.totalScore || 0;
                this.app.userData.stats.totalScore += 10; // æ¯æ¬¡åŒ¹é…åŠ 10åˆ†
                this.app.autoSave();
            }
            
            // æ¸¸æˆè®¡æ—¶å™¨
            startTimer() {
                this.gameInterval = setInterval(() => {
                    this.timer--;
                    document.getElementById('game-timer').textContent = `${this.timer}ç§’`;
                    
                    if (this.timer <= 0) {
                        this.gameOver();
                    }
                    
                    // æœ€å10ç§’è­¦å‘Š
                    if (this.timer <= 10) {
                        document.getElementById('game-timer').style.color = '#ff4444';
                    }
                }, 1000);
            }
            
            // å¼€å§‹æ¸¸æˆ
            start() {
                if (this.isPlaying) return;
                
                this.isPlaying = true;
                this.timer = 60;
                this.score = 0;
                this.matchedPairs = 0;
                this.selected = null;
                
                this.createGrid();
                this.renderGrid();
                this.updateGameDisplay();
                this.startTimer();
                
                // æ›´æ–°æ¸¸æˆæ¬¡æ•°
                this.app.userData.stats.totalGames = (this.app.userData.stats.totalGames || 0) + 1;
                this.app.autoSave();
                
                document.getElementById('current-food-info').innerHTML = `
                    <p>æ¸¸æˆå¼€å§‹ï¼ç‚¹å‡»ç›¸é‚»çš„ç›¸åŒé£Ÿç‰©è¿›è¡Œæ¶ˆé™¤</p>
                `;
                
                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                document.getElementById('pause-game').innerHTML = '<i class="fas fa-pause"></i> æš‚åœ';
            }
            
            // æš‚åœæ¸¸æˆ
            pause() {
                if (!this.isPlaying) return;
                
                if (this.gameInterval) {
                    clearInterval(this.gameInterval);
                    this.gameInterval = null;
                    this.isPlaying = false;
                    
                    document.getElementById('pause-game').innerHTML = '<i class="fas fa-play"></i> ç»§ç»­';
                    document.getElementById('current-food-info').innerHTML = '<p>æ¸¸æˆå·²æš‚åœï¼Œç‚¹å‡»"ç»§ç»­"ç»§ç»­æ¸¸æˆ</p>';
                } else {
                    this.isPlaying = true;
                    this.startTimer();
                    document.getElementById('pause-game').innerHTML = '<i class="fas fa-pause"></i> æš‚åœ';
                    document.getElementById('current-food-info').innerHTML = '<p>æ¸¸æˆç»§ç»­ï¼</p>';
                }
            }
            
            // é‡æ–°å¼€å§‹æ¸¸æˆ
            restart() {
                this.stop();
                this.start();
            }
            
            // åœæ­¢æ¸¸æˆ
            stop() {
                if (this.gameInterval) {
                    clearInterval(this.gameInterval);
                    this.gameInterval = null;
                }
                this.isPlaying = false;
                
                document.getElementById('pause-game').innerHTML = '<i class="fas fa-pause"></i> æš‚åœ';
                document.getElementById('game-timer').style.color = '';
            }
            
            // æ¸¸æˆèƒœåˆ©
            gameWin() {
                this.stop();
                
                // é¢å¤–å¥–åŠ±åˆ†æ•°
                const timeBonus = this.timer * 10;
                this.score += timeBonus;
                this.updateGameDisplay();
                
                // æ›´æ–°æœ€ä½³åˆ†æ•°
                if (this.score > (this.app.userData.stats.bestScore || 0)) {
                    this.app.userData.stats.bestScore = this.score;
                }
                
                this.app.autoSave();
                
                alert(`ğŸ‰ æ­å–œï¼æ‚¨æˆåŠŸå®Œæˆäº†æ¸¸æˆï¼\nå¾—åˆ†: ${this.score} (æ—¶é—´å¥–åŠ±: ${timeBonus}åˆ†)\nåŒ¹é…å¯¹æ•°: ${this.matchedPairs}`);
                
                document.getElementById('current-food-info').innerHTML = `
                    <p>ğŸ‰ æ¸¸æˆå®Œæˆï¼å¾—åˆ†: ${this.score} | åŒ¹é…å¯¹æ•°: ${this.matchedPairs}</p>
                `;
            }
            
            // æ¸¸æˆç»“æŸ
            gameOver() {
                this.stop();
                
                // æ›´æ–°æ¸¸æˆæ—¶é—´
                this.app.userData.stats.totalTime = (this.app.userData.stats.totalTime || 0) + (60 - this.timer);
                this.app.autoSave();
                
                alert(`â° æ—¶é—´åˆ°ï¼æ¸¸æˆç»“æŸ\næœ€ç»ˆå¾—åˆ†: ${this.score}\næˆåŠŸåŒ¹é…: ${this.matchedPairs}å¯¹`);
                
                document.getElementById('current-food-info').innerHTML = `
                    <p>â° æ—¶é—´åˆ°ï¼æœ€ç»ˆå¾—åˆ†: ${this.score} | åŒ¹é…å¯¹æ•°: ${this.matchedPairs}</p>
                `;
            }
            
            // è®¾ç½®æ¸¸æˆæ§åˆ¶
            setupGameControls() {
                document.getElementById('start-game-btn').addEventListener('click', () => {
                    this.app.startGame();
                });
                
                document.getElementById('restart-game').addEventListener('click', () => {
                    this.app.restartGame();
                });
                
                document.getElementById('pause-game').addEventListener('click', () => {
                    this.app.pauseGame();
                });
                
                document.getElementById('back-to-menu').addEventListener('click', () => {
                    this.app.backToMenu();
                });
            }
        }

        // ==================== åˆå§‹åŒ–åº”ç”¨ ====================
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–åº”ç”¨
        document.addEventListener('DOMContentLoaded', () => {
            // åˆ›å»ºå…¨å±€åº”ç”¨å®ä¾‹
            window.app = new HealthFoodAssistant();
            
            console.log('ğŸ® å¥åº·é¥®é£ŸåŠ©æ‰‹å·²å®Œå…¨åŠ è½½');
            console.log('ğŸ± é£Ÿç‰©æ•°æ®åº“:', KOREAN_FOODS.length, 'ç§éŸ©å›½é£Ÿç‰©');
            console.log('ğŸ‘¤ ç”¨æˆ·æ•°æ®å·²åˆå§‹åŒ–');
            console.log('âœ… åº”ç”¨å‡†å¤‡å°±ç»ª');
        });
    </script>
</body>
</html>
