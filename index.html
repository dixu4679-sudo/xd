<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>å¥åº·é¥®é£Ÿé€‰æ‹©åŠ©æ‰‹ Â· Healthy Food Helper</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, "Noto Sans CJK SC", "Noto Sans KR", sans-serif;
      background: #f5f7fb;
      color: #2d3436;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }
    h1 {
      text-align: center;
      font-size: 26px;
      margin-bottom: 10px;
    }
    .login-box, .search-box, .result-box, .rank-box {
      background: #fff;
      padding: 16px;
      margin-top: 16px;
      border-radius: 10px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    }
    input, button {
      padding: 8px 12px;
      font-size: 14px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      background: #4b7bec;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      filter: brightness(1.1);
    }
    .food-item {
      padding: 6px 0;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
    }
  </style>
</head>
<body>

<div class="container">

  <h1>ğŸ¥— å¥åº·é¥®é£Ÿé€‰æ‹©åŠ©æ‰‹ Healthy Food Helper</h1>

  <!-- ç™»å½•æ¨¡å— -->
  <div class="login-box">
    <h3>ç™»å½• / ì‹œì‘í•˜ê¸°</h3>
    <input type="text" id="userName" placeholder="è¯·è¾“å…¥æ˜µç§°æˆ–å­¦å·" />
    <button id="loginBtn">ç™»å½•</button>
    <p id="currentUser" style="color:#555;margin-top:6px;">å½“å‰æœªç™»å½•</p>
  </div>

  <!-- æœç´¢æ¨¡å— -->
  <div class="search-box">
    <h3>é£Ÿç‰©æŸ¥è¯¢ / ì¹¼ë¡œë¦¬ ê²€ìƒ‰</h3>
    <input type="text" id="foodInput" placeholder="è¾“å…¥é£Ÿç‰©åç§°â€¦" />
    <button id="searchBtn">æŸ¥è¯¢</button>
  </div>

  <!-- æ˜¾ç¤ºç»“æœ -->
  <div class="result-box">
    <h3>æŸ¥è¯¢ç»“æœ</h3>
    <div id="resultArea">æš‚æ— æ•°æ®ï¼Œè¯·å…ˆæŸ¥è¯¢ã€‚</div>
  </div>

  <!-- æ’è¡Œæ¦œ -->
  <div class="rank-box">
    <h3>ğŸ”¥ çƒ­é—¨é£Ÿç‰© TOP 10</h3>
    <div id="rankList">åŠ è½½ä¸­â€¦</div>
  </div>

</div>

<!-- Firebase JS SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
/* ---------------- Firebase é…ç½®ï¼ˆä½ çš„çœŸå®é…ç½®ï¼‰ ---------------- */
const firebaseConfig = {
  apiKey: "AIzaSyBCrHD2f3beCX83FZwpCCqMf2lT7WeF8Lg",
  authDomain: "healthy-eating-and-recreation.firebaseapp.com",
  databaseURL: "https://healthy-eating-and-recreation-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "healthy-eating-and-recreation",
  storageBucket: "healthy-eating-and-recreation.appspot.com",
  messagingSenderId: "282757556302",
  appId: "1:282757556302:web:df373651ffe71efca1bb1f",
  measurementId: "G-BPG2KSLHF7"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* ---------------- ç®€å•é£Ÿç‰©æ•°æ®åº“ ---------------- */
const FOOD_DATA = {
  "è‹¹æœ": { kcal: 52, protein: 0.3, fat: 0.2, carbs: 14, category: "æ°´æœ", info: "å¯Œå«ç»´ç”Ÿç´ Cï¼Œé€‚åˆä½œä¸ºåŠ é¤ã€‚" },
  "é¦™è•‰": { kcal: 96, protein: 1.2, fat: 0.3, carbs: 27, category: "æ°´æœ", info: "è¡¥å……èƒ½é‡ä½³å“ï¼Œé€‚åˆè¿åŠ¨å‰é£Ÿç”¨ã€‚" },
  "è¥¿ç“œ": { kcal: 30, protein: 0.6, fat: 0.2, carbs: 8, category: "æ°´æœ", info: "æ°´åˆ†é«˜ï¼Œè¡¥æ°´ä½³å“ã€‚" },
  "è‰è“": { kcal: 33, protein: 0.7, fat: 0.3, carbs: 8, category: "æ°´æœ", info: "å¯Œå«æŠ—æ°§åŒ–ç‰©è´¨ã€‚" },
  "è‘¡è„": { kcal: 69, protein: 0.7, fat: 0.2, carbs: 18, category: "æ°´æœ", info: "å«å¤©ç„¶ç³–åˆ†è¾ƒé«˜ï¼Œé€‚é‡å³å¯ã€‚" },

  "é¸¡èƒ¸è‚‰": { kcal: 165, protein: 31, fat: 3.6, carbs: 0, category: "è‚‰ç±»", info: "é«˜è›‹ç™½ä½è„‚ï¼Œæ˜¯å¥èº«å¸¸è§é£Ÿæã€‚" },
  "ç‰›æ’": { kcal: 271, protein: 26, fat: 19, carbs: 0, category: "è‚‰ç±»", info: "é“å«é‡é«˜ï¼Œä½†è„‚è‚ªä¹Ÿè¾ƒé«˜ã€‚" },
  "çŒªé‡Œè„Š": { kcal: 150, protein: 20, fat: 7, carbs: 0, category: "è‚‰ç±»", info: "æ¯”äº”èŠ±è‚‰æ›´å¥åº·ã€‚" },
  "ç«é¸¡èƒ¸": { kcal: 135, protein: 29, fat: 1, carbs: 0, category: "è‚‰ç±»", info: "éå¸¸ä½è„‚çš„ä¼˜è´¨è›‹ç™½æ¥æºã€‚" },

  "ç±³é¥­": { kcal: 116, protein: 2.6, fat: 0.3, carbs: 25, category: "ä¸»é£Ÿ", info: "ä¸»é£Ÿä¹‹ä¸€ï¼Œå¯æ­é…è”¬èœé™ä½å‡ç³–ã€‚" },
  "é¢æ¡": { kcal: 138, protein: 4.5, fat: 0.9, carbs: 27, category: "ä¸»é£Ÿ", info: "ç¢³æ°´è¡¥ç»™ä½³å“ï¼Œé€‚é‡é£Ÿç”¨ã€‚" },
  "çº¢è–¯": { kcal: 86, protein: 1.6, fat: 0.1, carbs: 20, category: "ä¸»é£Ÿ", info: "å‡ç³–æ¯”ç±³é¥­ä½ï¼Œæ˜¯ä¼˜è´¨ç¢³æ°´ã€‚" },
  "ç‡•éº¦": { kcal: 389, protein: 17, fat: 7, carbs: 66, category: "ä¸»é£Ÿ", info: "å¯Œå«è†³é£Ÿçº¤ç»´ï¼Œæ—©é¤å¥½é€‰æ‹©ã€‚" },

  "æ²™æ‹‰": { kcal: 35, protein: 1, fat: 0.2, carbs: 7, category: "è½»é£Ÿ", info: "ä½çƒ­é‡ï¼Œé€‚åˆå‡è„‚æœŸé—´ã€‚" },
  "é¸¡è‚‰å·": { kcal: 250, protein: 18, fat: 9, carbs: 24, category: "è½»é£Ÿ", info: "è¥å…»å‡è¡¡ï¼Œä¾¿æºæ–¹ä¾¿ã€‚" },
  "é…¸å¥¶": { kcal: 59, protein: 3.5, fat: 0.4, carbs: 7, category: "ä¹³åˆ¶å“", info: "å«ç›Šç”ŸèŒï¼Œæœ‰åŠ©è‚ é“å¥åº·ã€‚" },

  "å¯ä¹": { kcal: 42, protein: 0, fat: 0, carbs: 11, category: "é¥®æ–™", info: "å«ç³–é«˜ï¼Œå»ºè®®å°‘å–ã€‚" },
  "ç‰›å¥¶": { kcal: 61, protein: 3.2, fat: 3.3, carbs: 5, category: "é¥®æ–™", info: "é’™çš„è‰¯å¥½æ¥æºã€‚" },
  "æ©™æ±": { kcal: 45, protein: 0.7, fat: 0.2, carbs: 10, category: "é¥®æ–™", info: "ç»´ç”Ÿç´ Cä¸°å¯Œï¼Œä½†å«ç³–ä¹Ÿé«˜ã€‚" },

  "ç‚¸é¸¡": { kcal: 260, protein: 15, fat: 12, carbs: 20, category: "é«˜çƒ­é‡", info: "é«˜æ²¹è„‚é«˜çƒ­é‡ï¼Œå°½é‡å°‘åƒã€‚" },
  "è–¯æ¡": { kcal: 312, protein: 3.4, fat: 15, carbs: 41, category: "é«˜çƒ­é‡", info: "æ²¹ç‚¸é£Ÿå“ï¼Œå»ºè®®å‡å°‘æ‘„å…¥ã€‚" },
  "æŠ«è¨": { kcal: 266, protein: 11, fat: 10, carbs: 33, category: "é«˜çƒ­é‡", info: "ç¾å‘³ä½†çƒ­é‡é«˜ï¼Œé€‚é‡å³å¯ã€‚" },

  "æ³¡èœ": { kcal: 40, protein: 1.1, fat: 0.5, carbs: 7, category: "éŸ©å›½æ–™ç†", info: "å¼€èƒƒä½³å“ï¼Œä½†å«ç›è¾ƒé«˜ã€‚" },
  "ç´«èœåŒ…é¥­": { kcal: 200, protein: 6, fat: 3, carbs: 36, category: "éŸ©å›½æ–™ç†", info: "ç¢³æ°´åé«˜ï¼Œé€‚åˆä½œä¸ºç®€é¤ã€‚" },
  "è¾£ç‚’å¹´ç³•": { kcal: 240, protein: 3, fat: 1.2, carbs: 55, category: "éŸ©å›½æ–™ç†", info: "é«˜ç¢³æ°´ï¼Œå°½é‡å°‘åƒã€‚" }


};

/* ---------------- ç™»å½•åŠŸèƒ½ ---------------- */
let currentUser = null;
document.getElementById("loginBtn").onclick = () => {
  const name = document.getElementById("userName").value.trim();
  if (!name) return alert("è¯·è¾“å…¥æ˜µç§°æˆ–å­¦å·ï¼");
  currentUser = name;
  document.getElementById("currentUser").innerText = "å½“å‰ç”¨æˆ·ï¼š" + currentUser;
};

/* ---------------- æœç´¢åŠŸèƒ½ ---------------- */
document.getElementById("searchBtn").onclick = () => {
  const name = document.getElementById("foodInput").value.trim();
  if (!name) return alert("è¯·è¾“å…¥é£Ÿç‰©ï¼");

  if (!FOOD_DATA[name]) {
    document.getElementById("resultArea").innerHTML = "æ•°æ®åº“ä¸­æš‚æ— è¯¥é£Ÿç‰©ã€‚";
    return;
  }

  const f = FOOD_DATA[name];
  document.getElementById("resultArea").innerHTML =
    `<strong>${name}</strong><br>çƒ­é‡ï¼š${f.kcal} kcal<br>${f.info}`;

  // å†™å…¥ Firebase ç»Ÿè®¡è®°å½•
  db.ref("logs").push({
    user: currentUser || "Guest",
    food: name,
    timestamp: Date.now()
  });
};

/* ---------------- æ’è¡Œæ¦œå®æ—¶æ›´æ–° ---------------- */
db.ref("logs").on("value", snapshot => {
  const logs = snapshot.val();
  if (!logs) {
    document.getElementById("rankList").innerHTML = "æš‚æ— æ•°æ®ã€‚";
    return;
  }

  const count = {};
  Object.values(logs).forEach(log => {
    if (!count[log.food]) count[log.food] = 0;
    count[log.food]++;
  });

  const items = Object.entries(count)
    .sort((a,b) => b[1]-a[1])
    .slice(0,10)
    .map(([name, times]) => `<div class="food-item"><span>${name}</span><span>${times} æ¬¡</span></div>`);

  document.getElementById("rankList").innerHTML = items.join("");
});
</script>

</body>
</html>

