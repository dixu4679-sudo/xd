<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>å¥åº·é¥®é£Ÿé€‰æ‹©åŠ©æ‰‹ Â· Healthy Food Helper</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      /* èƒŒæ™¯ä¸ä¸»è‰²ï¼šæµ…é»„è‰² + æµ…è“è‰²æ­é… */
      --bg: #fffef5;
      --bg-soft: #f8faff;
      --card: #ffffff;

      --primary: #5d8aff;      /* ä¸»é¢˜è“ */
      --primary-soft: #e8f0ff; /* å¾ˆæ·¡çš„è“è‰²å— */

      --accent-yellow: #ffc145;      /* ç‚¹ç¼€é»„ */
      --accent-yellow-soft: #fff5e0; /* å¾ˆæ·¡çš„é»„è‰²å— */

      --accent-blue: #5d8aff;
      --accent-blue-soft: #e8f0ff;

      --danger: #ff7675;
      --success: #00b894;
      --warning: #f6a44c;

      --text-main: #2d3436;
      --text-sub: #636e72;

      --border-soft: #e3e7f0;
      --shadow-soft: 0 18px 45px rgba(170, 188, 212, 0.24);
    }

    * {
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue",
        Arial, "Noto Sans CJK SC", "Noto Sans KR", sans-serif;
    }

    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background: radial-gradient(circle at top, #fff8e5 0, #fffef5 45%, #f4f7ff 100%);
      color: var(--text-main);
    }

    .app {
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px 12px 32px;
    }

    /* ========== æ¬¢è¿å¼¹çª—ï¼ˆç¬¬ä¸€é¡µï¼‰ ========== */
    .welcome-overlay {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, #fff8e5 0, #fffef5 50%, #ffffff 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 20;
    }

    .welcome-card {
      width: 640px;
      max-width: 92vw;
      background: #ffffff;
      border-radius: 26px;
      box-shadow: var(--shadow-soft);
      padding: 26px 32px 26px;
      display: flex;
      flex-direction: column;
      gap: 18px;
      position: relative;
    }

    .welcome-tag {
      position: absolute;
      top: 18px;
      right: 22px;
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      background: var(--accent-yellow-soft);
      color: var(--accent-yellow);
    }

    .welcome-header {
      display: flex;
      gap: 14px;
      align-items: center;
    }

    .welcome-icon {
      width: 52px;
      height: 52px;
      border-radius: 20px;
      background: radial-gradient(circle at 30% 20%, #fff9e6 0, #ffe7a8 40%, #c5d8ff 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 30px;
    }

    .welcome-title-block h1 {
      margin: 0;
      font-size: 22px;
      font-weight: 700;
    }

    .welcome-subtitle {
      margin: 4px 0 0;
      font-size: 13px;
      color: var(--text-sub);
    }

    .welcome-form {
      margin-top: 6px;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .field-label {
      font-size: 13px;
      margin-bottom: 4px;
    }

    .field-label span {
      font-size: 12px;
      color: var(--text-sub);
      margin-left: 3px;
    }

    .welcome-input {
      width: 100%;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      padding: 9px 14px;
      font-size: 14px;
      outline: none;
      background: #fbfcff;
    }

    .welcome-input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(93, 138, 255, 0.25);
      background: #ffffff;
    }

    .lang-pill-row {
      display: inline-flex;
      gap: 6px;
      padding: 4px;
      border-radius: 999px;
      background: #f7f8ff;
      border: 1px solid #ecf0ff;
    }

    .lang-pill {
      border-radius: 999px;
      border: none;
      background: transparent;
      padding: 4px 10px;
      font-size: 13px;
      cursor: pointer;
      color: var(--text-sub);
    }

    .lang-pill.active {
      background: #ffffff;
      box-shadow: 0 0 0 1px rgba(93, 138, 255, 0.7);
      color: var(--accent-blue);
      font-weight: 600;
    }

    .welcome-btn-row {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-top: 4px;
    }

    .btn-primary {
      border-radius: 999px;
      border: none;
      padding: 9px 20px;
      font-size: 14px;
      cursor: pointer;
      background: linear-gradient(135deg, var(--primary), #7da2ff);
      color: #fff;
      box-shadow: 0 10px 22px rgba(93, 138, 255, 0.45);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .btn-primary:hover {
      filter: brightness(1.03);
      transform: translateY(-1px);
    }

    .welcome-tip {
      font-size: 11px;
      color: var(--text-sub);
      margin-top: 2px;
    }

    @media (max-width: 720px) {
      .welcome-card {
        padding: 22px 18px 20px;
      }
    }

    /* ========== ä¸»å¸ƒå±€ï¼šå·¦ä¾§å¯¼èˆª + å³ä¾§å†…å®¹ ========== */
    .layout {
      margin-top: 80px; /* é¿å…æ¬¢è¿å¡ç‰‡å…³é—­å‰çœ‹åˆ° */
      display: flex;
      gap: 16px;
      min-height: 520px;
    }

    .sidebar {
      width: 230px;
      min-width: 210px;
      border-radius: 20px;
      background: linear-gradient(160deg, rgba(255, 248, 227, 0.98), rgba(240, 246, 255, 0.98));
      border: 1px solid rgba(255, 230, 184, 0.85);
      box-shadow: 0 14px 40px rgba(216, 189, 211, 0.45);
      padding: 16px 14px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      position: relative;
      overflow: hidden;
    }

    .sidebar::before {
      content: "";
      position: absolute;
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.9) 0, rgba(255, 255, 255, 0) 70%);
      top: -40px;
      right: -30px;
      opacity: 0.7;
    }

    .sidebar-header {
      display: flex;
      align-items: center;
      gap: 8px;
      position: relative;
      z-index: 1;
    }

    .sidebar-logo {
      width: 36px;
      height: 36px;
      border-radius: 16px;
      background: radial-gradient(circle at 30% 20%, #fff, #ffe9b3 60%, #c5d8ff 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
    }

    .sidebar-title {
      font-size: 15px;
      font-weight: 700;
    }

    .sidebar-sub {
      font-size: 11px;
      color: var(--text-sub);
    }

    .sidebar-user {
      margin-top: 6px;
      padding: 8px 10px;
      border-radius: 14px;
      background: rgba(255, 255, 255, 0.95);
      border: 1px dashed rgba(255, 212, 168, 0.9);
      font-size: 12px;
      display: flex;
      flex-direction: column;
      gap: 2px;
      position: relative;
      z-index: 1;
    }

    .sidebar-user strong {
      font-size: 13px;
    }

    .sidebar-lang-indicator {
      font-size: 11px;
      color: var(--accent-blue);
    }

    .nav-section-label {
      margin-top: 4px;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: var(--text-sub);
      opacity: 0.9;
    }

    .nav-btns {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 4px;
      position: relative;
      z-index: 1;
    }

    .nav-btn {
      border-radius: 999px;
      border: none;
      padding: 7px 11px;
      font-size: 13px;
      text-align: left;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(255, 255, 255, 0.9);
      color: var(--text-main);
      border: 1px solid rgba(255, 230, 184, 0.8);
    }

    .nav-btn span.icon {
      font-size: 16px;
    }

    .nav-btn.active {
      background: linear-gradient(135deg, var(--primary), #7da2ff);
      color: #ffffff;
      border-color: transparent;
      box-shadow: 0 10px 22px rgba(93, 138, 255, 0.55);
    }

    .nav-btn.active .icon {
      transform: translateY(-0.5px);
    }

    .nav-footer {
      margin-top: auto;
      font-size: 11px;
      color: var(--text-sub);
      opacity: 0.9;
      z-index: 1;
    }

    .nav-logout {
      margin-top: 6px;
      font-size: 11px;
      color: #ff6b81;
      cursor: pointer;
      text-decoration: underline;
    }

    /* å³ä¾§å†…å®¹åŒºåŸŸ */
    .content {
      flex: 1;
      border-radius: 24px;
      background: rgba(255, 255, 255, 0.96);
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(227, 233, 248, 0.8);
      padding: 16px 18px 18px;
      min-width: 0;
    }

    .content-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .content-title-block h2 {
      margin: 0;
      font-size: 18px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .content-title-block p {
      margin: 3px 0 0;
      font-size: 12px;
      color: var(--text-sub);
    }

    .chip-soft {
      font-size: 11px;
      padding: 2px 7px;
      border-radius: 999px;
      background: var(--accent-blue-soft);
      color: var(--accent-blue);
    }

    .section {
      display: none;
    }

    .section.active {
      display: block;
    }

    /* ========= æŸ¥è¯¢é¡µæ ·å¼ ========= */
    .search-row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }

    .search-input {
      flex: 1;
      min-width: 180px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      padding: 8px 12px;
      font-size: 14px;
      outline: none;
      background: #fbfcff;
    }

    .search-input:focus {
      border-color: var(--accent-blue);
      box-shadow: 0 0 0 2px rgba(93, 138, 255, 0.25);
      background: #ffffff;
    }

    .btn-soft {
      border-radius: 999px;
      border: none;
      padding: 8px 13px;
      font-size: 13px;
      cursor: pointer;
      background: #f4f6ff;
      color: var(--accent-blue);
      border: 1px solid #dfe7ff;
    }

    .btn-soft:hover {
      background: #e7ecff;
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 10px;
    }

    .food-chip {
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      padding: 4px 10px;
      font-size: 12px;
      color: var(--text-sub);
      background: #fafbff;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .food-chip:hover {
      border-color: var(--accent-blue);
      color: var(--accent-blue);
      background: #f1f4ff;
    }

    .food-summary {
      font-size: 14px;
      margin-bottom: 8px;
      font-weight: 600;
    }

    .result-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 10px;
      margin-top: 6px;
    }

    .stat-box {
      border-radius: 16px;
      padding: 10px 12px;
      background: #f9fbff;
      border: 1px solid #e2e8ff;
      font-size: 12px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .stat-label {
      color: var(--text-sub);
      font-size: 11px;
    }

    .stat-value {
      font-weight: 600;
      font-size: 14px;
    }

    .small-badge {
      font-size: 11px;
      padding: 1px 6px;
      border-radius: 999px;
      background: #eef1ff;
      color: var(--accent-blue);
      margin-left: 4px;
    }

    .tips {
      font-size: 12px;
      line-height: 1.5;
    }

    .recipes {
      margin-top: 8px;
      font-size: 12px;
    }

    .recipes h4 {
      margin: 0 0 4px;
      font-size: 12px;
    }

    .recipes ul {
      margin: 2px 0 0;
      padding-left: 18px;
    }

    .empty-hint {
      font-size: 13px;
      color: var(--text-sub);
      margin-top: 6px;
    }

    /* ========= å°æ¸¸æˆ åŒºåŸŸ ========= */
    .game-top-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
      font-size: 13px;
    }

    .game-pill {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 9px;
      border-radius: 999px;
      background: var(--accent-blue-soft);
      color: var(--accent-blue);
      font-size: 12px;
    }

    .game-info {
      font-size: 12px;
      color: var(--text-sub);
    }

    .btn-game {
      border-radius: 999px;
      border: none;
      padding: 7px 14px;
      font-size: 13px;
      cursor: pointer;
      background: linear-gradient(135deg, var(--primary), #7da2ff);
      color: #fff;
      box-shadow: 0 10px 20px rgba(93, 138, 255, 0.45);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .game-board {
      margin-top: 10px;
      background: #fafbff;
      border-radius: 18px;
      border: 1px solid #e1e6ff;
      padding: 10px;
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 6px;
      max-width: 480px;
    }

    .tile {
      aspect-ratio: 1 / 1;
      border-radius: 12px;
      background: #ffffff;
      border: 1px solid #e0e5ff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(193, 206, 255, 0.35);
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.08s;
    }

    .tile.selected {
      border-color: var(--accent-blue);
      transform: translateY(-1px);
      box-shadow: 0 6px 14px rgba(118, 165, 255, 0.6);
      background: #f1f4ff;
    }

    .tile.matched {
      visibility: hidden;
    }

    .game-status-row {
      margin-top: 8px;
      font-size: 12px;
      color: var(--text-sub);
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }

    .badge-soft {
      padding: 2px 8px;
      border-radius: 999px;
      background: #f4f7ff;
      border: 1px solid #dde4ff;
      font-size: 11px;
    }

    /* ========= ç»Ÿè®¡é¡µ ========= */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
      gap: 8px;
      margin-top: 6px;
      font-size: 12px;
    }

    .stat-card {
      border-radius: 16px;
      padding: 9px 11px;
      background: #f9fbff;
      border: 1px solid #e1e6ff;
    }

    .stat-card .stat-label {
      font-size: 11px;
      color: var(--text-sub);
    }

    .stat-card .stat-value {
      font-size: 14px;
      font-weight: 600;
    }

    .top-foods-list {
      list-style: none;
      padding: 0;
      margin: 6px 0 0;
      font-size: 12px;
    }

    .top-foods-list li {
      display: flex;
      justify-content: space-between;
      padding: 3px 0;
      border-bottom: 1px dashed #ecf0f1;
    }

    .top-foods-list li span.count {
      color: var(--accent-blue);
      font-weight: 600;
    }

    footer {
      margin-top: 16px;
      font-size: 11px;
      text-align: center;
      color: var(--text-sub);
    }

    @media (max-width: 860px) {
      .layout {
        flex-direction: column;
      }
      .sidebar {
        flex-direction: row;
        align-items: center;
        width: 100%;
        min-height: 84px;
        border-radius: 18px;
      }
      .sidebar-header {
        flex: 1;
      }
      .sidebar-user,
      .nav-section-label,
      .nav-footer {
        display: none;
      }
      .nav-btns {
        flex-direction: row;
        flex: 1;
        justify-content: flex-end;
      }
      .nav-btn {
        font-size: 12px;
        padding-inline: 10px;
      }
      .content {
        margin-top: 4px;
      }
    }
  </style>
</head>
<body>
<div class="app">
  <!-- ===== æ¬¢è¿é¡µï¼šè¯­è¨€é€‰æ‹© + ç™»å½• ===== -->
  <div class="welcome-overlay" id="welcomeOverlay">
    <div class="welcome-card">
      <div class="welcome-tag">mini web</div>
      <div class="welcome-header">
        <div class="welcome-icon">ğŸ¥—</div>
        <div class="welcome-title-block">
          <h1 id="welcomeTitle">å¥åº·é¥®é£Ÿé€‰æ‹©åŠ©æ‰‹</h1>
          <p class="welcome-subtitle" id="welcomeSubtitle">
            ç®€å•è®°å½•ä½ çš„é£Ÿç‰©æŸ¥è¯¢ï¼Œè·å¾—æ›´å¥åº·çš„é¥®é£Ÿå»ºè®®ï¼Œè¿˜å¯ä»¥é€šè¿‡å°æ¸¸æˆå­¦ä¹ ä¸€ç‚¹è¥å…»çŸ¥è¯†ã€‚
          </p>
        </div>
      </div>

      <div class="welcome-form">
        <!-- è¯­è¨€åœ¨ä¸Š -->
        <div>
          <div class="field-label" id="labelLang">è¯­è¨€ / Language</div>
          <div class="lang-pill-row">
            <button type="button" class="lang-pill active" data-lang="zh" id="langBtnZh">CN ä¸­æ–‡</button>
            <button type="button" class="lang-pill" data-lang="kr" id="langBtnKo">KR í•œêµ­ì–´</button>
          </div>
        </div>

        <!-- æ˜µç§°åœ¨ä¸‹ -->
        <div>
          <div class="field-label" id="labelName">
            æ˜µç§° / å­¦å· <span id="labelNameHint">ä¾‹å¦‚ï¼šå°ç•ªèŒ„åŒå­¦ã€2025xxx</span>
          </div>
          <input id="welcomeNameInput" class="welcome-input"
                 placeholder="è¯·è¾“å…¥ä½ çš„æ˜µç§°æˆ–å­¦å·" />
        </div>

        <div class="welcome-btn-row">
          <button class="btn-primary" id="welcomeStartBtn">
            <span>âœ¨</span><span id="btnStartText">è¿›å…¥å°åŠ©æ‰‹</span>
          </button>
        </div>

        <div class="welcome-tip" id="welcomeTip">
          æç¤ºï¼šç³»ç»Ÿä¼šç”¨ä½ å¡«å†™çš„æ˜µç§°è®°å½•æŸ¥è¯¢è¡Œä¸ºå’Œå°æ¸¸æˆæˆç»©ï¼Œä»…ç”¨äºè¯¾å ‚å±•ç¤ºã€‚
        </div>
      </div>
    </div>
  </div>

  <!-- ===== ä¸»å¸ƒå±€ï¼šå·¦ä¾§å¯¼èˆª + å³ä¾§å†…å®¹ ===== -->
  <div class="layout" id="mainLayout" style="opacity:0.25;pointer-events:none;">
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">ğŸ¥—</div>
        <div>
          <div class="sidebar-title" id="sideTitle">å¥åº·é¥®é£ŸåŠ©æ‰‹</div>
          <div class="sidebar-sub" id="sideSubtitle">Food Â· Stats Â· Game</div>
        </div>
      </div>

      <div class="sidebar-user">
        <div id="sideUserLine"><strong>è®¿å®¢</strong></div>
        <div class="sidebar-lang-indicator" id="sideLangLine">å½“å‰è¯­è¨€ï¼šä¸­æ–‡</div>
      </div>

      <div class="nav-section-label" id="navSectionLabel">åŠŸèƒ½ / Features</div>
      <div class="nav-btns">
        <button class="nav-btn active" data-target="section-search" id="navSearch">
          <span class="icon">ğŸ”</span><span id="navSearchText">é£Ÿç‰©æŸ¥è¯¢</span>
        </button>
        <button class="nav-btn" data-target="section-game" id="navGame">
          <span class="icon">ğŸ®</span><span id="navGameText">è¿è¿çœ‹å°æ¸¸æˆ</span>
        </button>
        <button class="nav-btn" data-target="section-stats" id="navStats">
          <span class="icon">ğŸ“Š</span><span id="navStatsText">ç»Ÿè®¡ä¸æ’è¡Œæ¦œ</span>
        </button>
      </div>

      <div class="nav-footer">
        <div id="navFooterText">å°å°ç½‘é¡µå®éªŒ Â· ä»…è¯¾å ‚å±•ç¤ºä½¿ç”¨ã€‚</div>
        <div class="nav-logout" id="navLogout">é‡æ–°ç™»å½• / ì–¸ì–´ ë‹¤ì‹œ ì„ íƒ</div>
      </div>
    </aside>

    <main class="content">
      <!-- é¡¶éƒ¨æ ‡é¢˜ï¼Œæ ¹æ®å½“å‰ tab & è¯­è¨€åˆ‡æ¢ -->
      <div class="content-header">
        <div class="content-title-block">
          <h2 id="contentTitle"><span>ğŸ”</span><span id="contentTitleText">é£Ÿç‰©æŸ¥è¯¢</span></h2>
          <p id="contentSubtitle">
            è¾“å…¥å¸¸è§é£Ÿç‰©åç§°ï¼ŒæŸ¥çœ‹çƒ­é‡ä¸è¥å…»ç»“æ„ï¼Œå¹¶å¾—åˆ°ç®€å•å¥åº·å»ºè®®ã€‚
          </p>
        </div>
        <div class="chip-soft" id="contentChip">Firebase + ç»Ÿè®¡å†³ç­– mini demo</div>
      </div>

      <!-- ========== Section 1ï¼šé£Ÿç‰©æŸ¥è¯¢ ========== -->
      <section class="section active" id="section-search">
        <div class="search-row">
          <input id="foodInput" class="search-input" placeholder="è¾“å…¥é£Ÿç‰©ï¼Œå¦‚ï¼šè‹¹æœ / ç‰›å¥¶ / é¸¡èƒ¸è‚‰" />
          <button class="btn-soft" id="searchBtn">æœç´¢</button>
        </div>

        <div class="chip-row">
          <div class="food-chip" data-key="è‹¹æœ">ğŸ è‹¹æœ</div>
          <div class="food-chip" data-key="ç±³é¥­">ğŸš ç±³é¥­</div>
          <div class="food-chip" data-key="ç‰›å¥¶">ğŸ¥› ç‰›å¥¶</div>
          <div class="food-chip" data-key="é¸¡èƒ¸è‚‰">ğŸ— é¸¡èƒ¸è‚‰</div>
          <div class="food-chip" data-key="èƒ¡èåœ">ğŸ¥• èƒ¡èåœ</div>
          <div class="food-chip" data-key="å¯ä¹">ğŸ¥¤ å¯ä¹</div>
        </div>

        <div id="foodResultArea"></div>

        <div id="foodDetail" style="display:none;">
          <div class="result-grid">
            <div class="stat-box">
              <span class="stat-label" id="calorieLabel">çƒ­é‡</span>
              <span class="stat-value" id="calorieValue">120 kcal</span>
            </div>

            <div class="stat-box">
              <span class="stat-label" id="proteinLabel">è›‹ç™½è´¨</span>
              <span class="stat-value" id="proteinValue">6 g</span>
            </div>

            <div class="stat-box">
              <span class="stat-label" id="fatLabel">è„‚è‚ª</span>
              <span class="stat-value" id="fatValue">1.3 g</span>
            </div>

            <div class="stat-box">
              <span class="stat-label" id="carbLabel">ç¢³æ°´åŒ–åˆç‰©</span>
              <span class="stat-value" id="carbValue">20 g</span>
            </div>
          </div>

          <div class="tips" id="healthTip" style="margin-top:10px;">
            ğŸ‘ å»ºè®®ï¼šæ°´æœå¯Œå«ç»´ç”Ÿç´ ï¼Œå¯ä½œä¸ºåŠ é¤ï¼Œä½†è¦é¿å…ä¸€æ¬¡åƒå¤ªå¤šã€‚
          </div>

          <div class="recipes">
            <h4 id="recipeTitle">æ¨èæ­é…ï¼š</h4>
            <ul id="recipeList">
              <li>ğŸ è‹¹æœ + ğŸ¥› ç‰›å¥¶ï¼ˆå¢å¼ºé¥±è…¹æ„Ÿï¼‰</li>
              <li>ğŸ è‹¹æœ + ğŸ¥œ åšæœï¼ˆç»´ç”Ÿç´  + å¥åº·è„‚è‚ªï¼‰</li>
            </ul>
          </div>
        </div>

        <div class="empty-hint" id="emptyHint" style="display:none;">æœªæŸ¥è¯¢åˆ°è¯¥é£Ÿç‰©ï¼Œè¯·å°è¯•å…¶ä»–å…³é”®è¯ã€‚</div>
      </section>

      <!-- ========== Section 2ï¼šè¿è¿çœ‹å°æ¸¸æˆ ========== -->
      <section class="section" id="section-game">
        <div class="game-top-row">
          <span class="game-pill" id="gameLevelText">ç¬¬ 1 å…³ Â· åˆé˜¶</span>
          <span class="game-info" id="gameInfoText">ç‚¹å‡»ä¸¤ä¸ªç›¸åŒé£Ÿç‰©å³å¯æ¶ˆé™¤ Â· æ¯å…³ 60 ç§’</span>
          <button class="btn-game" id="gameStartBtn">å¼€å§‹æ¸¸æˆ</button>
        </div>

        <div class="game-status-row">
          <span class="badge-soft" id="timerText">â± 60 ç§’</span>
          <span class="badge-soft" id="matchCountText">å·²æ¶ˆé™¤ï¼š0 ç»„</span>
        </div>

        <div class="game-board" id="gameBoard"></div>
      </section>

      <!-- ========== Section 3ï¼šç»Ÿè®¡ä¸æ’è¡Œæ¦œï¼ˆæœ¬æ¬¡ä¼šè¯ï¼‰ ========== -->
      <section class="section" id="section-stats">
        <h2 class="section-title" id="statsTitle">ç»Ÿè®¡ä¸æ’è¡Œæ¦œ</h2>
        <p class="section-desc" id="statsDesc">
          æ ¹æ®ä½ åœ¨æœ¬æ¬¡ä½¿ç”¨ä¸­çš„é£Ÿç‰©æŸ¥è¯¢ä¸å°æ¸¸æˆç»“æœï¼Œç»™å‡ºä¸€äº›ç®€å•çš„ç»Ÿè®¡æŒ‡æ ‡ï¼Œä»…ç”¨äºè¯¾å ‚å±•ç¤ºã€‚
        </p>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-label" id="statSearchLabel">ç´¯è®¡æŸ¥è¯¢æ¬¡æ•°</div>
            <div class="stat-value" id="statSearchCount">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label" id="statAvgCalLabel">å¹³å‡çƒ­é‡ï¼ˆæŸ¥è¯¢é£Ÿç‰©ï¼‰</div>
            <div class="stat-value" id="statAvgCal">0 kcal</div>
          </div>
          <div class="stat-card">
            <div class="stat-label" id="statHealthyLabel">è¾ƒå¥åº·é€‰æ‹©æ¬¡æ•°</div>
            <div class="stat-value" id="statHealthyCount">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label" id="statWarningLabel">éœ€è¦æ³¨æ„çš„é£Ÿç‰©</div>
            <div class="stat-value" id="statWarningCount">0</div>
          </div>
        </div>

        <div class="stat-subblock">
          <h3 class="sub-title" id="topFoodsTitle">æœ¬æ¬¡æŸ¥è¯¢ä¸­å‡ºç°æœ€å¤šçš„é£Ÿç‰© TOP 3</h3>
          <ul class="top-foods-list" id="topFoodsList">
            <li class="empty-hint">è¿˜æ²¡æœ‰æ•°æ®ï¼Œå¯ä»¥å…ˆå»ä¸Šæ–¹çš„ã€Œé£Ÿç‰©æŸ¥è¯¢ã€ç©ä¸€ç©ã€‚</li>
          </ul>
        </div>
      </section>

    </main>
  </div> <!-- /main-layout -->
</div>   <!-- /app-wrapper -->

<!-- è½»é‡æç¤ºå¼¹çª—ï¼šç”¨äºå±•ç¤ºè¥å…»å»ºè®® -->
<div id="toast"
     style="position:fixed;left:50%;bottom:24px;transform:translateX(-50%) translateY(10px);
            background:rgba(0,0,0,0.78);color:#fff;padding:8px 16px;border-radius:999px;
            font-size:12px;opacity:0;pointer-events:none;transition:opacity .25s,transform .25s;
            z-index:50;">
</div>

<script>
(function () {
  'use strict';

  /* ===================== åŸºç¡€å¤šè¯­è¨€æ–‡æœ¬ ===================== */
  const TEXTS = {
    zh: {
      /* æ¬¢è¿é¡µ */
      welcomeTitle: 'å¥åº·é¥®é£Ÿé€‰æ‹©åŠ©æ‰‹',
      welcomeSubtitle: 'ç®€å•è®°å½•ä½ çš„é£Ÿç‰©æŸ¥è¯¢ï¼Œè·å¾—æ›´å¥åº·çš„é¥®é£Ÿå»ºè®®ï¼Œè¿˜å¯ä»¥é€šè¿‡å°æ¸¸æˆå­¦ä¹ ä¸€ç‚¹è¥å…»çŸ¥è¯†ã€‚',
      labelLang: 'è¯­è¨€ / Language',
      labelName: 'æ˜µç§° / å­¦å·',
      labelNameHint: 'ä¾‹å¦‚ï¼šå°ç•ªèŒ„åŒå­¦ã€2025xxx',
      welcomeInputPlaceholder: 'è¯·è¾“å…¥ä½ çš„æ˜µç§°æˆ–å­¦å·',
      btnStartText: 'è¿›å…¥å°åŠ©æ‰‹',
      welcomeTip: 'æç¤ºï¼šç³»ç»Ÿä¼šç”¨ä½ å¡«å†™çš„æ˜µç§°è®°å½•æŸ¥è¯¢è¡Œä¸ºå’Œå°æ¸¸æˆæˆç»©ï¼Œä»…ç”¨äºè¯¾å ‚å±•ç¤ºã€‚',

      /* ä¾§è¾¹æ  & é¡¶éƒ¨ */
      sideTitle: 'å¥åº·é¥®é£ŸåŠ©æ‰‹',
      sideSubtitle: 'Food Â· Stats Â· Game',
      sideLangText: 'å½“å‰è¯­è¨€ï¼šä¸­æ–‡',
      navSectionLabel: 'åŠŸèƒ½ / Features',
      navFooterText: 'å°å°ç½‘é¡µå®éªŒ Â· ä»…è¯¾å ‚å±•ç¤ºä½¿ç”¨ã€‚',
      navLogout: 'é‡æ–°ç™»å½• / ì–¸ì–´ ë‹¤ì‹œé€‰æ‹©',

      navSearch: 'é£Ÿç‰©æŸ¥è¯¢',
      navGame: 'å°æ¸¸æˆ',
      navStats: 'ç»Ÿè®¡ä¸æ’è¡Œæ¦œ',

      /* é¡¶éƒ¨æ¯ä¸ª section æ ‡é¢˜å’Œè¯´æ˜ */
      searchTitle: 'é£Ÿç‰©æŸ¥è¯¢',
      searchDesc: 'è¾“å…¥å¸¸è§é£Ÿç‰©åç§°ï¼ŒæŸ¥çœ‹çƒ­é‡ä¸è¥å…»ç»“æ„ï¼Œå¹¶å¾—åˆ°ç®€å•å¥åº·å»ºè®®ã€‚',
      gameTitle: 'è¿è¿çœ‹å°æ¸¸æˆ',
      gameDesc: 'é€šè¿‡ç®€å•çš„é…å¯¹å°æ¸¸æˆï¼Œé¡ºä¾¿è®°ä½ä¸€äº›åŸºç¡€çš„è¥å…»çŸ¥è¯†ã€‚',
      statsTitle: 'ç»Ÿè®¡ä¸æ’è¡Œæ¦œ',
      statsDesc: 'æ ¹æ®ä½ åœ¨æœ¬æ¬¡ä½¿ç”¨ä¸­çš„é£Ÿç‰©æŸ¥è¯¢ä¸å°æ¸¸æˆç»“æœï¼Œç»™å‡ºä¸€äº›ç®€å•çš„ç»Ÿè®¡æŒ‡æ ‡ï¼Œä»…ç”¨äºè¯¾å ‚å±•ç¤ºã€‚',

      /* æŸ¥è¯¢é¡µ */
      searchPlaceholder: 'è¾“å…¥é£Ÿç‰©ï¼Œå¦‚ï¼šè‹¹æœ / ç‰›å¥¶ / é¸¡èƒ¸è‚‰',
      statSearchLabel: 'ç´¯è®¡æŸ¥è¯¢æ¬¡æ•°',
      statAvgCalLabel: 'å¹³å‡çƒ­é‡ï¼ˆæŸ¥è¯¢é£Ÿç‰©ï¼‰',
      statHealthyLabel: 'è¾ƒå¥åº·é€‰æ‹©æ¬¡æ•°',
      statWarningLabel: 'éœ€è¦æ³¨æ„çš„é£Ÿç‰©',
      topFoodsTitle: 'æœ¬æ¬¡æŸ¥è¯¢ä¸­å‡ºç°æœ€å¤šçš„é£Ÿç‰© TOP 3',
      topFoodsEmpty: 'è¿˜æ²¡æœ‰æ•°æ®ï¼Œå¯ä»¥å…ˆå»ä¸Šæ–¹çš„ã€Œé£Ÿç‰©æŸ¥è¯¢ã€ç©ä¸€ç©ã€‚',

      /* æ¸¸æˆé¡µ */
      gameLevel1: 'ç¬¬ 1 å…³ Â· åˆé˜¶',
      gameLevel2: 'ç¬¬ 2 å…³ Â· è¿›é˜¶',
      gameInfo: 'ç‚¹å‡»ä¸¤ä¸ªç›¸åŒé£Ÿç‰©å³å¯æ¶ˆé™¤ Â· æ¯å…³é™å®šæ—¶é—´',
      gameStart: 'å¼€å§‹æ¸¸æˆ',
      timerPrefix: 'â± ',
      timerSuffix: ' ç§’',
      matchPrefix: 'å·²æ¶ˆé™¤ï¼š',
      matchSuffix: ' ç»„',
      nextLevelToast: 'æ­å–œé€šå…³ï¼è‡ªåŠ¨è¿›å…¥ç¬¬ 2 å…³ï¼Œæ—¶é—´ä¼šæ›´ç´§å¼ ä¸€ç‚¹ï½',
      allClearToast: 'å¤ªæ£’äº†ï¼ä½ å·²å®Œæˆæ‰€æœ‰å…³å¡ï¼Œå¯ä»¥ç‚¹å‡»ã€Œå¼€å§‹æ¸¸æˆã€å†ä»ç¬¬ 1 å…³ç©èµ·ã€‚',

      /* å…¶ä»– */
      recipeTitle: 'æ¨èæ­é…ï¼š',
      emptyHint: 'æœªæŸ¥è¯¢åˆ°è¯¥é£Ÿç‰©ï¼Œè¯·å°è¯•å…¶ä»–å…³é”®è¯ã€‚',
    },
    kr: {
      /* æ¬¢è¿é¡µ */
      welcomeTitle: 'ê±´ê°• ì‹ë‹¨ ì„ íƒ ë„ìš°ë¯¸',
      welcomeSubtitle: 'ìì£¼ ë¨¹ëŠ” ìŒì‹ì„ ê°€ë³ê²Œ ì¡°íšŒí•˜ê³ , ë” ê±´ê°•í•œ ì„ íƒì„ ë„ì™€ì£¼ëŠ” ë¯¸ë‹ˆ ì›¹ì…ë‹ˆë‹¤. ê²Œì„ì„ í•˜ë©´ì„œ ì˜ì–‘ ì§€ì‹ë„ ë°°ì›Œ ë³´ì„¸ìš”.',
      labelLang: 'ì–¸ì–´ / Language',
      labelName: 'ë‹‰ë„¤ì„ / í•™ë²ˆ',
      labelNameHint: 'ì˜ˆ: ì‘ì€í† ë§ˆí† , 2025xxx',
      welcomeInputPlaceholder: 'ë‹‰ë„¤ì„ ë˜ëŠ” í•™ë²ˆì„ ì…ë ¥í•˜ì„¸ìš”',
      btnStartText: 'ì‹œì‘í•˜ê¸°',
      welcomeTip: 'ì•ˆë‚´: ì…ë ¥í•œ ë‹‰ë„¤ì„ì€ ìˆ˜ì—… ì‹œê°„ ì˜ˆì‹œ(ì¡°íšŒ ê¸°ë¡, ê²Œì„ ê²°ê³¼)ì—ë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.',

      /* ä¾§è¾¹æ  & é¡¶éƒ¨ */
      sideTitle: 'ê±´ê°• ì‹ë‹¨ ë„ìš°ë¯¸',
      sideSubtitle: 'Food Â· Stats Â· Game',
      sideLangText: 'í˜„ì¬ ì–¸ì–´: í•œêµ­ì–´',
      navSectionLabel: 'ê¸°ëŠ¥ / Features',
      navFooterText: 'ìˆ˜ì—…ìš© ë¯¸ë‹ˆ ì›¹ ì˜ˆì‹œì…ë‹ˆë‹¤.',
      navLogout: 'ë‹¤ì‹œ ë¡œê·¸ì¸ / ì–¸ì–´ ë³€ê²½',

      navSearch: 'ì‹í’ˆ ì¡°íšŒ',
      navGame: 'ë¯¸ë‹ˆ ê²Œì„',
      navStats: 'í†µê³„ Â· ë­í‚¹',

      /* é¡¶éƒ¨æ¯ä¸ª section æ ‡é¢˜å’Œè¯´æ˜ */
      searchTitle: 'ì‹í’ˆ ì¡°íšŒ',
      searchDesc: 'ìì£¼ ë¨¹ëŠ” ì‹í’ˆ ì´ë¦„ì„ ì…ë ¥í•˜ê³  ì¹¼ë¡œë¦¬ì™€ ì˜ì–‘ ì •ë³´ë¥¼ ê°„ë‹¨íˆ í™•ì¸í•´ ë³´ì„¸ìš”.',
      gameTitle: 'ë¯¸ë‹ˆ ë§¤ì¹­ ê²Œì„',
      gameDesc: 'ìŒì‹ ì•„ì´ì½˜ì„ ë§ì¶”ëŠ” ê°„ë‹¨í•œ ê²Œì„ìœ¼ë¡œ ì˜ì–‘ ì •ë³´ë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ ìµí˜€ ë³´ì„¸ìš”.',
      statsTitle: 'í†µê³„ì™€ ìˆœìœ„',
      statsDesc: 'ì´ë²ˆ ì‚¬ìš© ë™ì•ˆì˜ ì¡°íšŒ ê¸°ë¡ê³¼ ê²Œì„ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê°„ë‹¨í•œ ì§€í‘œë¥¼ ë³´ì—¬ì£¼ëŠ” í˜ì´ì§€ì…ë‹ˆë‹¤.',

      /* æŸ¥è¯¢é¡µ */
      searchPlaceholder: 'ì‚¬ê³¼ / ìš°ìœ  / ë‹­ê°€ìŠ´ì‚´ ë“± ì‹í’ˆì„ ì…ë ¥í•˜ì„¸ìš”',
      statSearchLabel: 'ì´ ì¡°íšŒ íšŸìˆ˜',
      statAvgCalLabel: 'ì¡°íšŒí•œ ì‹í’ˆì˜ í‰ê·  ì¹¼ë¡œë¦¬',
      statHealthyLabel: 'ë¹„êµì  ê±´ê°•í•œ ì„ íƒ íšŸìˆ˜',
      statWarningLabel: 'ì£¼ì˜ê°€ í•„ìš”í•œ ì‹í’ˆ ìˆ˜',
      topFoodsTitle: 'ì´ë²ˆ ì¡°íšŒì—ì„œ ê°€ì¥ ìì£¼ ë“±ì¥í•œ ì‹í’ˆ TOP 3',
      topFoodsEmpty: 'ì•„ì§ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ìœ„ì˜ ã€Œì‹í’ˆ ì¡°íšŒã€ë¥¼ ì´ìš©í•´ ë³´ì„¸ìš”.',

      /* æ¸¸æˆé¡µ */
      gameLevel1: '1ë‹¨ê³„ Â· ê¸°ì´ˆ',
      gameLevel2: '2ë‹¨ê³„ Â· ì‘ìš©',
      gameInfo: 'ê°™ì€ ìŒì‹ ë‘ ê°œë¥¼ í´ë¦­í•˜ë©´ ì œê±°ë©ë‹ˆë‹¤ Â· ê° ë‹¨ê³„ ì œí•œ ì‹œê°„',
      gameStart: 'ê²Œì„ ì‹œì‘',
      timerPrefix: 'â± ',
      timerSuffix: ' ì´ˆ',
      matchPrefix: 'ì œê±°í•œ ìŒ: ',
      matchSuffix: ' ê°œ',
      nextLevelToast: '1ë‹¨ê³„ë¥¼ í´ë¦¬ì–´í–ˆìŠµë‹ˆë‹¤! ì ì‹œ í›„ 2ë‹¨ê³„ê°€ ì‹œì‘ë©ë‹ˆë‹¤. ì‹œê°„ì´ ì¡°ê¸ˆ ë” ì§§ì•„ìš”.',
      allClearToast: 'ëª¨ë“  ë‹¨ê³„ë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! ë‹¤ì‹œ 1ë‹¨ê³„ë¶€í„° ë„ì „í•´ ë³´ì„¸ìš”.',

      /* å…¶ä»– */
      recipeTitle: 'ì¶”ì²œ ì¡°í•©:',
      emptyHint: 'í•´ë‹¹ ì‹í’ˆì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ì‹œë„í•´ ë³´ì„¸ìš”.',
    }
  };

  let currentLang = 'zh';
  let currentSection = 'section-search';

  /* ===================== DOM å¼•ç”¨ ===================== */

  // æ¬¢è¿é¡µ
  const langZhBtn = document.getElementById('langBtnZh');
  const langKrBtn = document.getElementById('langBtnKo');
  const startBtn  = document.getElementById('welcomeStartBtn');
  const nameInput = document.getElementById('welcomeNameInput');
  const welcomePanel = document.getElementById('welcomeOverlay');
  const mainLayout   = document.getElementById('mainLayout');

  const welcomeTitleEl   = document.getElementById('welcomeTitle');
  const welcomeSubtitleEl= document.getElementById('welcomeSubtitle');
  const labelLangEl      = document.getElementById('labelLang');
  const labelNameEl      = document.getElementById('labelName');
  const labelNameHintEl  = document.getElementById('labelNameHint');
  const btnStartTextEl   = document.getElementById('btnStartText');
  const welcomeTipEl     = document.getElementById('welcomeTip');

  // ä¾§è¾¹æ  & é¡¶éƒ¨
  const sideTitleEl   = document.getElementById('sideTitle');
  const sideSubtitleEl= document.getElementById('sideSubtitle');
  const sideLangLine  = document.getElementById('sideLangLine');
  const navSectionLabelEl = document.getElementById('navSectionLabel');
  const navFooterTextEl   = document.getElementById('navFooterText');
  const navLogoutEl       = document.getElementById('navLogout');

  const navSearch = document.getElementById('navSearchText');
  const navGame   = document.getElementById('navGameText');
  const navStats  = document.getElementById('navStatsText');

  const sections  = document.querySelectorAll('.section');

  const contentTitle   = document.getElementById('contentTitle');
  const contentTitleText = document.getElementById('contentTitleText');
  const contentSubtitle= document.getElementById('contentSubtitle');

  // æŸ¥è¯¢é¡µ
  const foodInput = document.getElementById('foodInput');
  const searchBtn = document.getElementById('searchBtn');
  const chips     = document.querySelectorAll('.food-chip');

  const foodResultArea = document.getElementById('foodResultArea');
  const foodDetail     = document.getElementById('foodDetail');
  const emptyHintEl    = document.getElementById('emptyHint');

  const calorieValue = document.getElementById('calorieValue');
  const proteinValue = document.getElementById('proteinValue');
  const fatValue     = document.getElementById('fatValue');
  const carbValue    = document.getElementById('carbValue');
  const healthTipEl  = document.getElementById('healthTip');
  const recipeTitle  = document.getElementById('recipeTitle');
  const recipeList   = document.getElementById('recipeList');

  // ç»Ÿè®¡é¡µ
  const statsTitleEl       = document.getElementById('statsTitle');
  const statsDescEl        = document.getElementById('statsDesc');
  const statSearchLabelEl  = document.getElementById('statSearchLabel');
  const statAvgCalLabelEl  = document.getElementById('statAvgCalLabel');
  const statHealthyLabelEl = document.getElementById('statHealthyLabel');
  const statWarningLabelEl = document.getElementById('statWarningLabel');
  const statSearchCountEl  = document.getElementById('statSearchCount');
  const statAvgCalEl       = document.getElementById('statAvgCal');
  const statHealthyCountEl = document.getElementById('statHealthyCount');
  const statWarningCountEl = document.getElementById('statWarningCount');
  const topFoodsTitleEl    = document.getElementById('topFoodsTitle');
  const topFoodsListEl     = document.getElementById('topFoodsList');

  // æ¸¸æˆç›¸å…³
  const gameLevelText  = document.getElementById('gameLevelText');
  const gameInfoText   = document.getElementById('gameInfoText');
  const gameStartBtn   = document.getElementById('gameStartBtn');
  const timerTextEl    = document.getElementById('timerText');
  const matchCountText = document.getElementById('matchCountText');
  const gameBoard      = document.getElementById('gameBoard');

  const toastEl = document.getElementById('toast');

  /* ===================== è½»é‡ Toast ===================== */
  function showToast (text) {
    if (!toastEl) return;
    toastEl.textContent = text;
    toastEl.style.opacity = '1';
    toastEl.style.transform = 'translateX(-50%) translateY(0)';
    setTimeout(() => {
      toastEl.style.opacity = '0';
      toastEl.style.transform = 'translateX(-50%) translateY(10px)';
    }, 2200);
  }

  /* ===================== ç®€å•é£Ÿç‰©æ•°æ®åº“ ===================== */
  const FOOD_ITEMS = [
    {
      id: 'apple',
      icon: 'ğŸ',
      keywords: ['è‹¹æœ', 'ì‚¬ê³¼', 'apple'],
      kcal: 52,
      protein: 0.3,
      fat: 0.2,
      carb: 14,
      level: 'good',
      zh: {
        name: 'è‹¹æœ',
        tip: 'å¯Œå«ç»´ç”Ÿç´  C å’Œè†³é£Ÿçº¤ç»´ï¼Œå¯ä½œä¸ºåŠ é¤æˆ–æ—©é¤é…é¤ã€‚',
        recipes: [
          'è‹¹æœ + åŸå‘³é…¸å¥¶ + ç‡•éº¦ï¼Œåšæˆé…¸å¥¶æ°´æœç¢—ã€‚',
          'åˆ‡ç‰‡è‹¹æœ + ä¸€å°æŠŠåšæœï¼Œä½œä¸ºä¸‹åˆå°ç‚¹å¿ƒã€‚'
        ],
        gameTip: 'æ°´æœæ›¿ä»£å«ç³–é›¶é£Ÿï¼Œå¯ä»¥åœ¨ä¿è¯å£æ„Ÿçš„åŒæ—¶å‡å°‘æ·»åŠ ç³–æ‘„å…¥ã€‚'
      },
      kr: {
        name: 'ì‚¬ê³¼',
        tip: 'ë¹„íƒ€ë¯¼ Cì™€ ì‹ì´ì„¬ìœ ê°€ í’ë¶€í•˜ì—¬ ê°„ì‹ì´ë‚˜ ì•„ì¹¨ ê³ë“¤ì´ê¸°ë¡œ ì¢‹ìŠµë‹ˆë‹¤.',
        recipes: [
          'ì‚¬ê³¼ + í”Œë ˆì¸ ìš”ê±°íŠ¸ + ì˜¤íŠ¸ë°€ë¡œ ê³¼ì¼ ìš”ê±°íŠ¸ ë³¼ ë§Œë“¤ê¸°.',
          'ì‚¬ê³¼ ìŠ¬ë¼ì´ìŠ¤ + ì†ŒëŸ‰ì˜ ê²¬ê³¼ë¥˜ë¥¼ ê³ë“¤ì—¬ ì˜¤í›„ ê°„ì‹ìœ¼ë¡œ í™œìš©í•˜ê¸°.'
        ],
        gameTip: 'ê³¼ì¼ì„ ë‹¬ì½¤í•œ ê³¼ì ëŒ€ì‹  ë¨¹ìœ¼ë©´ ë‹¹ ì„­ì·¨ë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
      }
    },
    {
      id: 'rice',
      icon: 'ğŸš',
      keywords: ['ç±³é¥­', 'ç™½ç±³é¥­', 'ë°¥', 'rice'],
      kcal: 130,
      protein: 2.4,
      fat: 0.3,
      carb: 28,
      level: 'mid',
      zh: {
        name: 'ç™½ç±³é¥­',
        tip: 'æ§åˆ¶ä»½é‡ï¼Œå¹¶æ­é…è¶³å¤Ÿè”¬èœä¸è›‹ç™½è´¨ï¼Œå¯ä»¥æˆä¸ºå‡è¡¡ä¸€é¤ã€‚',
        recipes: [
          'ä¸€ç¢—ç±³é¥­ + ä¸€ä»½è”¬èœ + ä¸€ä»½ç˜¦è‚‰æˆ–è±†è…ï¼Œç»„æˆç®€å•ã€Œå‡è¡¡é¥­ç¢—ã€ã€‚',
          'ç”¨ç³™ç±³éƒ¨åˆ†æ›¿ä»£ç™½ç±³ï¼Œå¯å¢åŠ è†³é£Ÿçº¤ç»´æ‘„å…¥ã€‚'
        ],
        gameTip: 'ç™½ç±³é¥­æœ¬èº«ä¸ç­‰äºã€Œä¸å¥åº·ã€ï¼Œå…³é”®æ˜¯ä»½é‡å’Œæ­é…æ˜¯å¦å‡è¡¡ã€‚'
      },
      kr: {
        name: 'ë°¥',
        tip: 'ì–‘ì„ ì¡°ì ˆí•˜ê³  ì±„ì†Œì™€ ë‹¨ë°±ì§ˆì„ í•¨ê»˜ ë¨¹ìœ¼ë©´ ê· í˜• ì¡íŒ í•œ ë¼ê°€ ë©ë‹ˆë‹¤.',
        recipes: [
          'ë°¥ í•œ ê³µê¸° + ì±„ì†Œ ë°˜ì°¬ + ì‚´ì½”ê¸°ë‚˜ ë‘ë¶€ë¥¼ ê³ë“¤ì¸ ì‹¬í”Œí•œ í•œ ê·¸ë¦‡.',
          'í°ìŒ€ ì¼ë¶€ë¥¼ í˜„ë¯¸ë¡œ ë°”ê¾¸ë©´ ì‹ì´ì„¬ìœ  ì„­ì·¨ë¥¼ ëŠ˜ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
        ],
        gameTip: 'ë°¥ ìì²´ê°€ ë‚˜ìœ ê²ƒì€ ì•„ë‹ˆë©°, ì–‘ê³¼ ë°˜ì°¬ êµ¬ì„±ì— ë”°ë¼ ì‹ì‚¬ì˜ ì§ˆì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤.'
      }
    },
    {
      id: 'milk',
      icon: 'ğŸ¥›',
      keywords: ['ç‰›å¥¶', 'ìš°ìœ ', 'milk'],
      kcal: 60,
      protein: 3.2,
      fat: 3.3,
      carb: 4.8,
      level: 'good',
      zh: {
        name: 'ç‰›å¥¶',
        tip: 'æä¾›ä¼˜è´¨è›‹ç™½å’Œé’™ï¼Œé€‰æ‹©ä½è„‚æˆ–è„±è„‚ç‰ˆæœ¬å¯ä»¥å‡å°‘é¥±å’Œè„‚è‚ªæ‘„å…¥ã€‚',
        recipes: [
          'æ—©é¤ï¼šç‰›å¥¶ + å…¨éº¦é¢åŒ… + æ°´æœã€‚',
          'ç”¨ç‰›å¥¶ä»£æ›¿å«ç³–å¥¶èŒ¶ï¼Œå¯å‡å°‘ä¸å°‘é¢å¤–ç³–åˆ†ã€‚'
        ],
        gameTip: 'é’™å’Œè›‹ç™½è´¨æœ‰åŠ©äºéª¨éª¼å’Œè‚Œè‚‰å¥åº·ï¼Œæ³¨æ„é€‰æ‹©å«ç³–é‡è¾ƒä½çš„ç‰ˆæœ¬ã€‚'
      },
      kr: {
        name: 'ìš°ìœ ',
        tip: 'ì–‘ì§ˆì˜ ë‹¨ë°±ì§ˆê³¼ ì¹¼ìŠ˜ì„ ì œê³µí•˜ë©°, ì €ì§€ë°©/ë¬´ì§€ë°© ì œí’ˆì„ ì„ íƒí•˜ë©´ í¬í™”ì§€ë°©ì„ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
        recipes: [
          'ì•„ì¹¨ ì‹ì‚¬: ìš°ìœ  + í†µê³¡ë¬¼ ë¹µ + ê³¼ì¼.',
          'ë‹¬ë‹¬í•œ ë°€í¬í‹° ëŒ€ì‹  ìš°ìœ ë¥¼ ë§ˆì‹œë©´ ë‹¹ ì„­ì·¨ë¥¼ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
        ],
        gameTip: 'ì¹¼ìŠ˜ê³¼ ë‹¨ë°±ì§ˆì€ ë¼ˆì™€ ê·¼ìœ¡ ê±´ê°•ì— ë„ì›€ì„ ì£¼ë©°, ë‹¹ì´ ì ì€ ì œí’ˆì„ ê³ ë¥´ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.'
      }
    },
    {
      id: 'chicken',
      icon: 'ğŸ—',
      keywords: ['é¸¡èƒ¸è‚‰', 'é¸¡è‚‰', 'ë‹­ê°€ìŠ´ì‚´', 'chicken'],
      kcal: 120,
      protein: 22,
      fat: 3,
      carb: 0,
      level: 'good',
      zh: {
        name: 'é¸¡èƒ¸è‚‰',
        tip: 'é«˜è›‹ç™½ã€ä½è„‚è‚ªï¼Œæ˜¯å¸¸è§çš„å¥èº«å‹å¥½å‹ä¸»èœã€‚',
        recipes: [
          'ç…æˆ–çƒ¤é¸¡èƒ¸è‚‰ + è”¬èœæ²™æ‹‰ï¼Œä½œä¸ºå‡è„‚é¤ã€‚',
          'é¸¡èƒ¸è‚‰åˆ‡ä¸ä¸è”¬èœåŒç‚’ï¼Œé…å°‘é‡ç±³é¥­ã€‚'
        ],
        gameTip: 'ä¼˜å…ˆé€‰æ‹©å°‘æ²¹çš„çƒ¹é¥ªæ–¹å¼ï¼Œå¯ä»¥åœ¨ä¿è¯è›‹ç™½è´¨æ‘„å…¥çš„åŒæ—¶æ§åˆ¶æ€»çƒ­é‡ã€‚'
      },
      kr: {
        name: 'ë‹­ê°€ìŠ´ì‚´',
        tip: 'ë‹¨ë°±ì§ˆì´ ë†’ê³  ì§€ë°©ì´ ì ì–´ ë‹¤ì´ì–´íŠ¸ ì‹ë‹¨ì— ìì£¼ ì‚¬ìš©ë©ë‹ˆë‹¤.',
        recipes: [
          'êµ¬ìš´ ë‹­ê°€ìŠ´ì‚´ + ìƒëŸ¬ë“œë¡œ ê°€ë²¼ìš´ ì‹ì‚¬ êµ¬ì„±.',
          'ë‹­ê°€ìŠ´ì‚´ì„ ì˜ê²Œ ì°ì–´ ì±„ì†Œì™€ í•¨ê»˜ ë³¶ê³  ë°¥ê³¼ ê³ë“¤ì—¬ ë¨¹ê¸°.'
        ],
        gameTip: 'íŠ€ê¸°ì§€ ì•Šê³  êµ½ê±°ë‚˜ ì‚¶ëŠ” ë°©ì‹ìœ¼ë¡œ ì¡°ë¦¬í•˜ë©´ ì—´ëŸ‰ì„ í¬ê²Œ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
      }
    },
    {
      id: 'carrot',
      icon: 'ğŸ¥•',
      keywords: ['èƒ¡èåœ', 'ë‹¹ê·¼', 'carrot'],
      kcal: 41,
      protein: 0.9,
      fat: 0.2,
      carb: 10,
      level: 'good',
      zh: {
        name: 'èƒ¡èåœ',
        tip: 'å«æœ‰Î²-èƒ¡èåœç´ ï¼Œæœ‰åŠ©äºç»´æŒæ­£å¸¸è§†åŠ›å’Œçš®è‚¤å¥åº·ã€‚',
        recipes: [
          'èƒ¡èåœç‚’è¥¿å…°èŠ±ï¼Œä½œä¸ºé…èœã€‚',
          'å°†èƒ¡èåœåˆ‡æ¡ï¼Œæ­é…é…¸å¥¶è˜¸é…±å½“å°é›¶é£Ÿã€‚'
        ],
        gameTip: 'æ©™è‰²è”¬èœé€šå¸¸å¯Œå«ç»´ç”Ÿç´  A å‰ä½“ï¼Œæœ‰åŠ©äºè§†åŠ›ä¸çš®è‚¤å¥åº·ã€‚'
      },
      kr: {
        name: 'ë‹¹ê·¼',
        tip: 'ë² íƒ€ì¹´ë¡œí‹´ì´ í’ë¶€í•˜ì—¬ ì‹œë ¥ê³¼ í”¼ë¶€ ê±´ê°•ì— ë„ì›€ì´ ë©ë‹ˆë‹¤.',
        recipes: [
          'ë‹¹ê·¼ê³¼ ë¸Œë¡œì½œë¦¬ë¥¼ í•¨ê»˜ ë³¶ì•„ ë°˜ì°¬ìœ¼ë¡œ í™œìš©.',
          'ë‹¹ê·¼ ìŠ¤í‹±ì„ ìš”ê±°íŠ¸ ë”¥ê³¼ í•¨ê»˜ ê°„ì‹ìœ¼ë¡œ ë¨¹ê¸°.'
        ],
        gameTip: 'ì£¼í™©ìƒ‰ ì±„ì†ŒëŠ” ë¹„íƒ€ë¯¼ A ì „êµ¬ì²´ê°€ í’ë¶€í•´ ëˆˆê³¼ í”¼ë¶€ ê±´ê°•ì— ì´ë¡­ìŠµë‹ˆë‹¤.'
      }
    },
    {
      id: 'cola',
      icon: 'ğŸ¥¤',
      keywords: ['å¯ä¹', 'ì½œë¼', 'cola'],
      kcal: 42,
      protein: 0,
      fat: 0,
      carb: 11,
      level: 'warn',
      zh: {
        name: 'å«ç³–é¥®æ–™ï¼ˆå¯ä¹ï¼‰',
        tip: 'å‡ ä¹åªæä¾›ç³–ä¸çƒ­é‡ï¼Œå»ºè®®å‡å°‘é¢‘ç‡æˆ–æ¢æˆæ— ç³–/ç™½æ°´/èŒ¶é¥®ã€‚',
        recipes: [
          'å°è¯•æ°”æ³¡æ°´ + æŸ æª¬ç‰‡ï¼Œä½œä¸ºæ›¿ä»£ã€‚',
          'ç”¨å†·æ³¡èŒ¶ä»£æ›¿å«ç³–é¥®æ–™ã€‚'
        ],
        gameTip: 'å«ç³–é¥®æ–™å¾ˆå®¹æ˜“åœ¨ä¸çŸ¥ä¸è§‰ä¸­æŠ¬é«˜ä¸€å¤©çš„æ€»çƒ­é‡å’Œç³–æ‘„å…¥ã€‚'
      },
      kr: {
        name: 'ë‹¹ë¶„ ìŒë£Œ(ì½œë¼)',
        tip: 'ê±°ì˜ ë‹¹ê³¼ ì—´ëŸ‰ë§Œ ì œê³µí•˜ë¯€ë¡œ, ë¹ˆë„ì™€ ì–‘ì„ ì¤„ì´ê³  ë¬¼/ë¬´ê°€ë‹¹ ì°¨ ë“±ìœ¼ë¡œ ëŒ€ì²´í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.',
        recipes: [
          'íƒ„ì‚°ìˆ˜ì— ë ˆëª¬ì„ ë„£ì–´ ìƒí¼í•œ ëŒ€ì²´ ìŒë£Œ ë§Œë“¤ê¸°.',
          'ê°€ë‹¹ ìŒë£Œ ëŒ€ì‹  ì½œë“œë¸Œë£¨ í‹°ë¥¼ ë§ˆì…” ë³´ê¸°.'
        ],
        gameTip: 'ë‹¹ë¶„ ìŒë£ŒëŠ” ê¸ˆë°© ì—¬ëŸ¬ ì”ì„ ë§ˆì‹œê²Œ ë˜ì–´ í•˜ë£¨ ì´ ì—´ëŸ‰ê³¼ ë‹¹ ì„­ì·¨ë¥¼ í¬ê²Œ ì˜¬ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
      }
    }
  ];

  const FOOD_BY_ID = {};
  FOOD_ITEMS.forEach(f => { FOOD_BY_ID[f.id] = f; });

  /* ===================== é¡¶éƒ¨æ ‡é¢˜åˆ‡æ¢ ===================== */
  function updateContentHeader(sectionId) {
    const t = TEXTS[currentLang];
    if (!contentTitleText || !contentSubtitle || !contentTitle) return;

    if (sectionId === 'section-search') {
      contentTitle.firstElementChild.textContent = 'ğŸ”';
      contentTitleText.textContent = t.searchTitle;
      contentSubtitle.textContent  = t.searchDesc;
    } else if (sectionId === 'section-game') {
      contentTitle.firstElementChild.textContent = 'ğŸ®';
      contentTitleText.textContent = t.gameTitle;
      contentSubtitle.textContent  = t.gameDesc;
    } else if (sectionId === 'section-stats') {
      contentTitle.firstElementChild.textContent = 'ğŸ“Š';
      contentTitleText.textContent = t.statsTitle;
      contentSubtitle.textContent  = t.statsDesc;
    }
  }

  /* ===================== è¯­è¨€åˆ‡æ¢ ===================== */
  function applyLanguage () {
    const t = TEXTS[currentLang];

    // æ¬¢è¿é¡µ
    if (welcomeTitleEl)    welcomeTitleEl.textContent    = t.welcomeTitle;
    if (welcomeSubtitleEl) welcomeSubtitleEl.textContent = t.welcomeSubtitle;
    if (labelLangEl)       labelLangEl.textContent       = t.labelLang;
    if (labelNameEl)       labelNameEl.firstChild.nodeValue = t.labelName + ' ';
    if (labelNameHintEl)   labelNameHintEl.textContent   = t.labelNameHint;
    if (nameInput)         nameInput.placeholder         = t.welcomeInputPlaceholder;
    if (btnStartTextEl)    btnStartTextEl.textContent    = t.btnStartText;
    if (welcomeTipEl)      welcomeTipEl.textContent      = t.welcomeTip;

    // ä¾§è¾¹æ 
    if (sideTitleEl)       sideTitleEl.textContent       = t.sideTitle;
    if (sideSubtitleEl)    sideSubtitleEl.textContent    = t.sideSubtitle;
    if (sideLangLine)      sideLangLine.textContent      = t.sideLangText;
    if (navSectionLabelEl) navSectionLabelEl.textContent = t.navSectionLabel;
    if (navFooterTextEl)   navFooterTextEl.textContent   = t.navFooterText;
    if (navLogoutEl)       navLogoutEl.textContent       = t.navLogout;

    if (navSearch) navSearch.textContent = t.navSearch;
    if (navGame)   navGame.textContent   = t.navGame;
    if (navStats)  navStats.textContent  = t.navStats;

    // é¡¶éƒ¨æ ‡é¢˜
    updateContentHeader(currentSection);

    // æŸ¥è¯¢é¡µ & ç»Ÿè®¡é¡µæ–‡æœ¬
    if (foodInput) foodInput.placeholder = t.searchPlaceholder;

    if (statsTitleEl)  statsTitleEl.textContent  = t.statsTitle;
    if (statsDescEl)   statsDescEl.textContent   = t.statsDesc;
    if (statSearchLabelEl)  statSearchLabelEl.textContent  = t.statSearchLabel;
    if (statAvgCalLabelEl)  statAvgCalLabelEl.textContent  = t.statAvgCalLabel;
    if (statHealthyLabelEl) statHealthyLabelEl.textContent = t.statHealthyLabel;
    if (statWarningLabelEl) statWarningLabelEl.textContent = t.statWarningLabel;
    if (topFoodsTitleEl)    topFoodsTitleEl.textContent    = t.topFoodsTitle;

    // æ¸¸æˆé¡µæ–‡æœ¬ï¼ˆå…³å¡æ ‡é¢˜å’Œè®¡æ—¶å™¨åœ¨é‡ç½®æ—¶ä¹Ÿä¼šæ ¹æ®å…³å¡å†æ›´æ–°ï¼‰
    if (gameInfoText)   gameInfoText.textContent  = t.gameInfo;
    if (gameLevelText) {
      gameLevelText.textContent = (currentLevel === 1) ? t.gameLevel1 : t.gameLevel2;
    }
    if (gameStartBtn)   gameStartBtn.textContent  = t.gameStart;
    if (timerTextEl) {
      timerTextEl.textContent = t.timerPrefix + timeLeft + t.timerSuffix;
    }
    if (matchCountText) {
      matchCountText.textContent = t.matchPrefix + matchedPairs + t.matchSuffix;
    }

    // å…¶ä»–
    if (recipeTitle)    recipeTitle.textContent   = t.recipeTitle;
    if (emptyHintEl)    emptyHintEl.textContent   = t.emptyHint;
  }

  function setLanguage (lang) {
    currentLang = lang === 'kr' ? 'kr' : 'zh';
    if (langZhBtn) langZhBtn.classList.toggle('active', currentLang === 'zh');
    if (langKrBtn) langKrBtn.classList.toggle('active', currentLang === 'kr');
    applyLanguage();
  }

  if (langZhBtn && langKrBtn) {
    langZhBtn.addEventListener('click', () => setLanguage('zh'));
    langKrBtn.addEventListener('click', () => setLanguage('kr'));
  }

  /* ===================== ç™»å½• / è¿›å…¥ä¸»ç•Œé¢ ===================== */
  if (startBtn && welcomePanel && mainLayout) {
    startBtn.addEventListener('click', () => {
      const name = nameInput ? nameInput.value.trim() : '';
      if (!name) {
        showToast(currentLang === 'zh'
          ? 'è¯·å…ˆè¾“å…¥ä¸€ä¸ªæ˜µç§°æˆ–å­¦å·~'
          : 'ë‹‰ë„¤ì„ ë˜ëŠ” í•™ë²ˆì„ ë¨¼ì € ì…ë ¥í•´ ì£¼ì„¸ìš” :)');
        if (nameInput) nameInput.focus();
        return;
      }
      welcomePanel.style.display = 'none';
      mainLayout.style.display = 'flex';
      mainLayout.style.opacity = '1';
      mainLayout.style.pointerEvents = 'auto';

      // ä¾§è¾¹æ æ˜¾ç¤ºæ˜µç§°
      const sideUserLine = document.getElementById('sideUserLine');
      if (sideUserLine) {
        sideUserLine.innerHTML = '<strong>' + name + '</strong>';
      }
    });
  }

  // å†ç™»å½•æŒ‰é’®
  if (navLogoutEl && welcomePanel && mainLayout) {
    navLogoutEl.addEventListener('click', () => {
      welcomePanel.style.display = 'flex';
      mainLayout.style.opacity = '0.25';
      mainLayout.style.pointerEvents = 'none';
    });
  }

  /* ===================== å·¦ä¾§å¯¼èˆªåˆ‡æ¢ Section ===================== */
  const navItems = document.querySelectorAll('.nav-btn');

  function showSection (id) {
    sections.forEach(sec => {
      if (sec.id === id) {
        sec.classList.add('active');
      } else {
        sec.classList.remove('active');
      }
    });
    currentSection = id;
    updateContentHeader(id);
  }

  navItems.forEach(item => {
    item.addEventListener('click', () => {
      navItems.forEach(i => i.classList.remove('active'));
      item.classList.add('active');
      const target = item.getAttribute('data-target');
      if (target) showSection(target);
    });
  });

  /* ===================== æŸ¥è¯¢é€»è¾‘ + ç»Ÿè®¡ ===================== */
  let searchCount = 0;
  let sumCal = 0;
  let healthyCount = 0;
  let warningCount = 0;
  const foodHitCounter = {};

  function findFoodByInput (raw) {
    const text = raw.trim().toLowerCase();
    if (!text) return null;
    for (const item of FOOD_ITEMS) {
      if (item.keywords.some(k => text.includes(k.toLowerCase()))) {
        return item;
      }
    }
    return null;
  }

  function renderFood (food) {
    const lang = food[currentLang];
    if (!lang) return;

    if (foodResultArea) {
      foodResultArea.innerHTML = `
        <div class="food-summary">
          <div class="food-main-name">${food.icon} ${lang.name}</div>
        </div>
      `;
    }

    if (calorieValue) calorieValue.textContent = food.kcal + ' kcal';
    if (proteinValue) proteinValue.textContent = food.protein + ' g';
    if (fatValue)     fatValue.textContent     = food.fat + ' g';
    if (carbValue)    carbValue.textContent    = food.carb + ' g';
    if (healthTipEl)  healthTipEl.textContent  = lang.tip;

    if (recipeList) {
      recipeList.innerHTML = '';
      lang.recipes.forEach(r => {
        const li = document.createElement('li');
        li.textContent = r;
        recipeList.appendChild(li);
      });
    }

    if (foodDetail)  foodDetail.style.display = 'block';
    if (emptyHintEl) emptyHintEl.style.display = 'none';
  }

  function updateStats (food) {
    searchCount += 1;
    sumCal += food.kcal;
    if (food.level === 'good') healthyCount += 1;
    if (food.level === 'warn') warningCount += 1;

    foodHitCounter[food.id] = (foodHitCounter[food.id] || 0) + 1;

    if (statSearchCountEl) statSearchCountEl.textContent = String(searchCount);
    if (statAvgCalEl) {
      const avg = searchCount ? (sumCal / searchCount).toFixed(1) : 0;
      statAvgCalEl.textContent = avg + ' kcal';
    }
    if (statHealthyCountEl) statHealthyCountEl.textContent = String(healthyCount);
    if (statWarningCountEl) statWarningCountEl.textContent = String(warningCount);

    if (topFoodsListEl) {
      topFoodsListEl.innerHTML = '';
      const entries = Object.entries(foodHitCounter)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 3);
      if (entries.length === 0) {
        const li = document.createElement('li');
        li.className = 'empty-hint';
        li.textContent = TEXTS[currentLang].topFoodsEmpty;
        topFoodsListEl.appendChild(li);
      } else {
        entries.forEach(([id, count]) => {
          const f = FOOD_BY_ID[id];
          if (!f) return;
          const li = document.createElement('li');
          li.innerHTML = `<span>${f.icon} ${f[currentLang].name}</span><span class="count">Ã— ${count}</span>`;
          topFoodsListEl.appendChild(li);
        });
      }
    }
  }

  function handleSearch () {
    if (!foodInput) return;
    const val = foodInput.value;
    const food = findFoodByInput(val);
    if (!food) {
      if (foodDetail)  foodDetail.style.display = 'none';
      if (emptyHintEl) {
        emptyHintEl.style.display = 'block';
        emptyHintEl.textContent = TEXTS[currentLang].emptyHint;
      }
      return;
    }
    renderFood(food);
    updateStats(food);
  }

  if (searchBtn && foodInput) {
    searchBtn.addEventListener('click', handleSearch);
    foodInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') handleSearch();
    });
  }

  chips.forEach(chip => {
    chip.addEventListener('click', () => {
      const key = chip.dataset.key || chip.textContent.trim();
      if (foodInput) foodInput.value = key;
      const food = findFoodByInput(key);
      if (food) {
        renderFood(food);
        updateStats(food);
      } else {
        handleSearch();
      }
    });
  });

  /* ===================== ç®€åŒ–ç‰ˆã€Œè¿è¿çœ‹ã€å°æ¸¸æˆï¼ˆä¸¤å…³ï¼‰ ===================== */
  const MAX_LEVEL = 2;
  let currentLevel = 1;

  let gameRunning = false;
  let timerId = null;
  let timeLeft = 60;
  let openedCard = null;
  let matchedPairs = 0;
  let totalPairs = 0;

  function getLevelTime() {
    // 1 å…³ 60 ç§’ï¼Œ2 å…³ 45 ç§’
    return currentLevel === 1 ? 60 : 45;
  }

  function resetGameState () {
    gameRunning = false;
    if (timerId) clearInterval(timerId);
    timerId = null;
    timeLeft = getLevelTime();
    openedCard = null;
    matchedPairs = 0;

    const t = TEXTS[currentLang];
    if (matchCountText) {
      matchCountText.textContent = t.matchPrefix + '0' + t.matchSuffix;
    }
    if (timerTextEl) {
      timerTextEl.textContent = t.timerPrefix + timeLeft + t.timerSuffix;
    }
    if (gameLevelText) {
      gameLevelText.textContent = currentLevel === 1 ? t.gameLevel1 : t.gameLevel2;
    }
  }

  function buildBoardForCurrentLevel () {
    if (!gameBoard) return;
    gameBoard.innerHTML = '';
    resetGameState();

    // ä½¿ç”¨ 6 ç§é£Ÿç‰©ï¼Œæ¯ç§ 4 å¼ ï¼Œå…± 24 å¼ ï¼ˆä¸¤å…³ç›¸åŒæ£‹ç›˜ï¼Œæ—¶é—´ä¸åŒï¼‰
    const pool = ['apple', 'rice', 'milk', 'chicken', 'carrot', 'cola'];
    const ids = [];
    pool.forEach(id => {
      ids.push(id, id, id, id); // æ¯ç§ 4 å¼ 
    });

    const cards = ids.slice(0, 24);
    totalPairs = cards.length / 2;

    // æ´—ç‰Œ
    for (let i = cards.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [cards[i], cards[j]] = [cards[j], cards[i]];
    }

    cards.forEach((id, index) => {
      const food = FOOD_BY_ID[id];
      if (!food) return;
      const div = document.createElement('div');
      div.className = 'tile game-card';
      div.dataset.foodId = id;
      div.dataset.index = index;
      div.textContent = food.icon;
      gameBoard.appendChild(div);
    });
  }

  function startTimer () {
    if (!timerTextEl) return;
    const tText = TEXTS[currentLang];
    timerTextEl.textContent = tText.timerPrefix + timeLeft + tText.timerSuffix;
    timerId = setInterval(() => {
      timeLeft -= 1;
      timerTextEl.textContent = tText.timerPrefix + timeLeft + tText.timerSuffix;
      if (timeLeft <= 0) {
        clearInterval(timerId);
        gameRunning = false;
        showToast(currentLang === 'zh'
          ? 'æ—¶é—´åˆ°å•¦ï¼Œæœ¬å…³ç»“æŸ~ å¯ä»¥ç‚¹å‡»é‡æ–°å¼€å§‹å†è¯•ä¸€æ¬¡ã€‚'
          : 'ì‹œê°„ ì¢…ë£Œ! ì´ë²ˆ íŒì´ ëë‚¬ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë„ì „í•´ ë³´ì„¸ìš” :)');
      }
    }, 1000);
  }

  function startGame () {
    buildBoardForCurrentLevel();
    gameRunning = true;
    timeLeft = getLevelTime();
    const t = TEXTS[currentLang];
    if (gameLevelText) {
      gameLevelText.textContent = currentLevel === 1 ? t.gameLevel1 : t.gameLevel2;
    }
    if (timerTextEl) {
      timerTextEl.textContent = t.timerPrefix + timeLeft + t.timerSuffix;
    }
    startTimer();
  }

  if (gameStartBtn) {
    gameStartBtn.addEventListener('click', () => {
      // æ¯æ¬¡æ‰‹åŠ¨ç‚¹â€œå¼€å§‹æ¸¸æˆâ€éƒ½ä»ç¬¬ 1 å…³é‡æ–°å¼€å§‹
      currentLevel = 1;
      startGame();
    });
  }

  if (gameBoard) {
    gameBoard.addEventListener('click', (e) => {
      const card = e.target.closest('.game-card');
      if (!card || !gameRunning) return;
      if (card.classList.contains('matched')) return;

      if (!openedCard) {
        openedCard = card;
        card.classList.add('selected');
        return;
      }

      if (openedCard === card) return;

      const id1 = openedCard.dataset.foodId;
      const id2 = card.dataset.foodId;

      if (id1 === id2) {
        // åŒ¹é…æˆåŠŸ
        openedCard.classList.remove('selected');
        openedCard.classList.add('matched');
        card.classList.add('matched');
        matchedPairs += 1;

        const food = FOOD_BY_ID[id1];
        if (food) {
          const tip = food[currentLang].gameTip;
          showToast(tip);
        }

        const t = TEXTS[currentLang];
        if (matchCountText) {
          matchCountText.textContent = t.matchPrefix + matchedPairs + t.matchSuffix;
        }

        if (matchedPairs >= totalPairs) {
          gameRunning = false;
          if (timerId) clearInterval(timerId);
          const t2 = TEXTS[currentLang];

          if (currentLevel < MAX_LEVEL) {
            showToast(t2.nextLevelToast);
            currentLevel += 1;
            setTimeout(() => {
              startGame();
            }, 1400);
          } else {
            showToast(t2.allClearToast);
          }
        }
      } else {
        // ä¸åŒ¹é…
        openedCard.classList.remove('selected');
      }

      openedCard = null;
    });
  }

  /* ===================== åˆå§‹åŒ– ===================== */
  setLanguage('zh');                 // é»˜è®¤ä¸­æ–‡
  showSection('section-search');     // é»˜è®¤æ˜¾ç¤ºæŸ¥è¯¢é¡µ
})();
</script>
</body>
</html>

